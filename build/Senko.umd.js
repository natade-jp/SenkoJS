/*!
 * SenkoJS
 * https://github.com/natade-jp/SenkoJS
 * Copyright 2013-2019 natade
 *
 * The MIT license.
 * https://opensource.org/licenses/MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Senko=e()}(this,function(){"use strict";function i(t){var e=arguments;if(this.element=[],1===arguments.length)for(var i=0;i<t.element.length;i++)this.element[i]=e[0].element[i]}i.prototype.each=function(t){for(var e=!0,i=0;i<this.element.length;i++){var n=this.element[i];if(!1===t.call(n,i,n)){e=!1;break}}return e},i.prototype.toString=function(){return this.join(", ")},i.prototype.isEmpty=function(){return 0===this.element.length},i.prototype.contains=function(t){return this.element.contains(t)},i.prototype.size=function(){return this.element.length},i.prototype.clear=function(){this.element.length=0},i.prototype.join=function(t){return 0===arguments.length&&(t=","),this.element.join(t)},i.prototype.clone=function(){for(var t=new i,e=0;e<this.element.length;e++)t.element[e]=this.element[e];return t},i.prototype.indexOf=function(t){for(var e=0;e<this.element.length;e++)if(this.element[e]===t)return e;return-1},i.prototype.lastIndexOf=function(t){for(var e=this.element.length-1;-1!==e;e--)if(this.element[e]===t)return e;return-1},i.prototype.get=function(t){return this.element[t]},i.prototype.add=function(t,e){if(1===arguments.length){var i=t;this.element.push(i)}else if(2===arguments.length){var n=t,o=e;this.element.splice(n,0,o)}},i.prototype.addAll=function(t,e){if(1===arguments.length)for(var i=t,n=this.element.length,o=0;o<i.length;o++)this.element[n++]=i.element[o];else if(2===arguments.length){var r=t,s=e.element;s===this.element&&(s=this.element.slice(0));for(var h=this.element.length-r,l=this.element.length+s.length-1,a=this.element.length-1,u=0;u<h;u++)this.element[l--]=this.element[a--];h=s.length;for(var p=0;p<h;p++)this.element[r++]=s[p]}},i.prototype.set=function(t,e){this.element[t]=e},i.prototype.remove=function(t){this.element.splice(t,1)},i.prototype.removeRange=function(t,e){this.element.splice(t,e-t)},i.prototype.sort=function(t){var e;e=0===arguments.length?i.COMPARE.DEFAULT:t;var a=[],u=function(t,e,i,n){if(e<i){var o=Math.floor((e+i)/2);u(t,e,o,n),u(t,o+1,i,n);var r,s,h,l=0;for(r=e;r<=o;r++)a[l++]=t[r];for(r=o+1,s=0,h=e;r<=i&&s<l;)0<=n(t[r],a[s])?t[h++]=a[s++]:t[h++]=t[r++];for(;s<l;)t[h++]=a[s++]}return!0};u(this.element,0,this.element.length-1,e)},(i.COMPARE={}).DEFAULT=function(t,e){return t===e?0:typeof t==typeof e?t<e?-1:1:typeof t<typeof e?-1:1};function p(){this.r=0,this.g=0,this.b=0,this.a=1}p.prototype.limit=function(){var t=new p;return t.r=p._limit(this.r),t.g=p._limit(this.g),t.b=p._limit(this.b),t.a=p._limit(this.a),t},p.prototype.bake=function(){var t=new p;return t.r=this.r*this.a,t.g=this.g*this.a,t.b=this.b*this.a,t.a=1,t.limit()},p.prototype.addColorMixture=function(t){if(!(t instanceof p))throw"IllegalArgumentException";return p.newColorNormalizedRGB(this.r+t.r*t.a,this.g+t.g*t.a,this.b+t.b*t.a,this.a)},p.prototype.subColorMixture=function(t){if(!(t instanceof p))throw"IllegalArgumentException";var e=Math.min(this.r,t.r),i=Math.min(this.g,t.g),n=Math.min(this.b,t.b);return p.newColorNormalizedRGB(p._mix(this.r,e,t.a),p._mix(this.g,i,t.a),p._mix(this.b,n,t.a),this.a)},p.prototype.mul=function(t){if(t instanceof p)return p.newColorNormalizedRGB(this.r*t.r,this.g*t.g,this.b*t.b,this.a*t.a);if("number"==typeof t||t instanceof Number)return p.newColorNormalizedRGB(this.r*t,this.g*t,this.b*t,this.a);throw"IllegalArgumentException"},p.prototype.clone=function(){var t=new p;return t.r=this.r,t.g=this.g,t.b=this.b,t.a=this.a,t},p.prototype.toString=function(){return"Color["+this.getCSSHex()+", "+this.getCSS255()+", "+this.getCSSPercent()+"]"},p._mix=function(t,e,i){return t+(e-t)*i},p._limit=function(t){return Math.max(Math.min(t,1),0)},p._flact=function(t){return t-Math.floor(t)},p._hex=function(t){return 1===(t=Math.round(255*t).toString(16)).length?"0"+t:t},p.prototype._setRGB=function(t,e,i,n){return this.r=t,this.g=e,this.b=i,n&&(this.a=n),this},p.prototype._setHSV=function(t,e,i,n){var o,r;return this.r=i,this.g=i,this.b=i,n&&(this.a=n),0<e&&(r=(t*=6)-(o=~~Math.floor(t)),0==o?(this.g*=1-e*(1-r),this.b*=1-e):1==o?(this.r*=1-e*r,this.b*=1-e):2==o?(this.r*=1-e,this.b*=1-e*(1-r)):3==o?(this.r*=1-e,this.g*=1-e*r):4==o?(this.r*=1-e*(1-r),this.g*=1-e):5==o&&(this.g*=1-e,this.b*=1-e*r)),this},p.prototype._setHSL=function(t,e,i,n){if(n&&(this.a=n),0===e)return this.r=0,this.g=0,this.b=0,this;var o,r=2*i-(o=i<.5?i*(1+e):i*(1-e)+e),s=o-r;t*=6;var h=~~Math.floor(t),l=t-h;return 0==h?(this.r=o,this.g=o-s*(1-l),this.b=r):1==h?(this.r=r+s*(1-l),this.g=o,this.b=r):2==h?(this.r=r,this.g=o,this.b=o-s*(1-l)):3==h?(this.r=r,this.g=r+s*(1-l),this.b=o):4==h?(this.r=o-s*(1-l),this.g=r,this.b=o):5==h&&(this.r=o,this.g=r,this.b=r+s*(1-l)),this},p.prototype._getRGB=function(){return{r:this.r,g:this.g,b:this.b,a:this.a}},p.prototype._getHSV=function(){var t=Math.max(this.r,this.g,this.b),e=Math.min(this.r,this.g,this.b),i=t-e,n=0,o=t-e,r=t;return 0!==t&&(o/=t),0==i?[n,o,r]:(t===this.r?(n=(this.g-this.b)/i)<0&&(n+=6):n=t===this.g?2+(this.b-this.r)/i:4+(this.r-this.g)/i,{h:n/=6,s:o,v:r,a:this.a})},p.prototype._getHSL=function(){var t,e,i=Math.max(this.r,this.g,this.b),n=Math.min(this.r,this.g,this.b),o=.5*(i+n),r=i-n;return 0==r?[0,o,0]:(t=o<.5?r/(i+n):r/(2-i-n),i===this.r?(e=(this.g-this.b)/r)<0&&(e+=6):e=i===this.g?2+(this.b-this.r)/r:4+(this.r-this.g)/r,{h:e/=6,s:t,l:o,a:this.a})},p.prototype.getNormalizedRGB=function(){return this._getRGB()},p.prototype.getRGB=function(){return{r:Math.round(255*this.r),g:Math.round(255*this.g),b:Math.round(255*this.b),a:Math.round(255*this.a)}},p.prototype.getRRGGBB=function(){return Math.round(255*p._limit(this.r))<<16|Math.round(255*p._limit(this.g))<<8|Math.round(255*p._limit(this.b))},p.prototype.getAARRGGBB=function(){return Math.round(255*p._limit(this.a))<<24|Math.round(255*p._limit(this.r))<<16|Math.round(255*p._limit(this.g))<<8|Math.round(255*p._limit(this.b))},p.prototype.getNormalizedHSV=function(){return this._getHSV()},p.prototype.getHSV=function(){var t=this.getNormalizedHSV();return t.h=Math.round(360*t.h),t.s=Math.round(255*t.s),t.v=Math.round(255*t.v),t.a=Math.round(255*t.a),t},p.prototype.getNormalizedHSL=function(){return this._getHSL()},p.prototype.getHSL=function(){var t=this.getNormalizedHSL();return t.h=Math.round(360*t.h),t.s=Math.round(255*t.s),t.l=Math.round(255*t.l),t.a=Math.round(255*t.a),t},p.prototype.getRed=function(){return Math.round(255*this.r)},p.prototype.getGreen=function(){return Math.round(255*this.g)},p.prototype.getBlue=function(){return Math.round(255*this.b)},p.prototype.getAlpha=function(){return Math.round(255*this.b)},p.prototype.brighter=function(){return this.mul(1/.7).limit()},p.prototype.darker=function(){return this.mul(.7).limit()},p.prototype.getCSSHex=function(){return 1===this.a?"#"+p._hex(p._limit(this.r))+p._hex(p._limit(this.g))+p._hex(p._limit(this.b)):"#"+p._hex(p._limit(this.a))+p._hex(p._limit(this.r))+p._hex(p._limit(this.g))+p._hex(p._limit(this.b))},p.prototype.getCSS255=function(){return 1===this.a?"rgb("+Math.round(255*p._limit(this.r))+","+Math.round(255*p._limit(this.g))+","+Math.round(255*p._limit(this.b))+")":"rgba("+Math.round(255*p._limit(this.r))+","+Math.round(255*p._limit(this.g))+","+Math.round(255*p._limit(this.b))+","+this.a+")"},p.prototype.getCSSPercent=function(){return 1===this.a?"rgb("+Math.round(100*p._limit(this.r))+"%,"+Math.round(100*p._limit(this.g))+"%,"+Math.round(100*p._limit(this.b))+"%)":"rgba("+Math.round(100*p._limit(this.r))+"%,"+Math.round(100*p._limit(this.g))+"%,"+Math.round(100*p._limit(this.b))+"%,"+Math.round(100*p._limit(this.a))+"%)"},p.prototype.setAlpha=function(t){var e=this.clone();return e.a=t,e},p.newColorNormalizedRGB=function(t,e,i,n){var o=0,r=0,s=0,h=1;1===arguments.length?(t.r&&(o=t.r),t.g&&(r=t.g),t.b&&(s=t.b),t.a&&(h=t.a),3<=t.length&&(o=t[0],r=t[1],s=t[2]),4<=t.length&&(h=t[3])):(3<=arguments.length&&(o=t,r=e,s=i),4<=arguments.length&&(h=n));var l=new p;return l._setRGB(o,r,s,h),l},p.newColorRGB=function(t,e,i,n){var o=0,r=0,s=0,h=255;3<=arguments.length?(o=t,r=e,s=i,4<=arguments.length&&(h=n)):1<=arguments.length&&("number"==typeof t?(o=t>>16&255,r=t>>8&255,s=255&t,e&&(h=t>>24&255)):void 0===t.length?(t.r&&(o=t.r),t.g&&(r=t.g),t.b&&(s=t.b),t.a&&(h=t.a)):3<=t.length&&(o=t[0],r=t[1],s=t[2],4<=t.length&&(h=t[3])));var l=new p;return l._setRGB(o/255,r/255,s/255,h/255),l},p.newColorNormalizedHSV=function(t,e,i,n){var o=0,r=0,s=0,h=1;1===arguments.length?(t.h&&(o=t.h),t.s&&(r=t.s),t.v&&(s=t.v),t.a&&(h=t.a),3<=t.length&&(o=t[0],r=t[1],s=t[2]),4<=t.length&&(h=t[3])):(3<=arguments.length&&(o=t,r=e,s=i),4<=arguments.length&&(h=n)),r=p._limit(r),s=p._limit(s);var l=new p;return l._setHSV(p._flact(o),r,s,h),l},p.newColorHSV=function(t,e,i,n){var o=0,r=0,s=0,h=255;return 1===arguments.length?(t.h&&(o=t.h),t.s&&(r=t.s),t.v&&(s=t.v),t.a&&(h=t.a),3<=t.length&&(o=t[0],r=t[1],s=t[2]),4<=t.length&&(h=t[3])):(3<=arguments.length&&(o=t,r=e,s=i),4<=arguments.length&&(h=n)),p.newColorNormalizedHSV(o/360,r/255,s/255,h/255)},p.newColorNormalizedHSL=function(t,e,i,n){var o=0,r=0,s=0,h=1;1===arguments.length?(t.h&&(o=t.h),t.s&&(r=t.s),t.l&&(s=t.l),t.a&&(h=t.a),3<=t.length&&(o=t[0],r=t[1],s=t[2]),4<=t.length&&(h=t[3])):(3<=arguments.length&&(o=t,r=e,s=i),4<=arguments.length&&(h=n)),r=p._limit(r),s=p._limit(s);var l=new p;return l._setHSL(p._flact(o),r,s,h),l},p.newColorHSL=function(t,e,i,n){var o=0,r=0,s=0,h=255;return 1===arguments.length?(t.h&&(o=t.h),t.s&&(r=t.s),t.l&&(s=t.l),t.a&&(h=t.a),3<=t.length&&(o=t[0],r=t[1],s=t[2]),4<=t.length&&(h=t[3])):(3<=arguments.length&&(o=t,r=e,s=i),4<=arguments.length&&(h=n)),p.newColorNormalizedHSL(o/360,r/255,s/255,h/255)},p.white=p.newColorRGB(16777215),p.lightGray=p.newColorRGB(13882323),p.gray=p.newColorRGB(8421504),p.darkGray=p.newColorRGB(11119017),p.black=p.newColorRGB(0),p.red=p.newColorRGB(16711680),p.pink=p.newColorRGB(16761035),p.orange=p.newColorRGB(16753920),p.yellow=p.newColorRGB(16776960),p.green=p.newColorRGB(32768),p.magenta=p.newColorRGB(16711935),p.cyan=p.newColorRGB(65535),p.blue=p.newColorRGB(255),p.WHITE=p.white,p.LIGHT_GRAY=p.lightGray,p.GRAY=p.gray,p.DARK_GRAY=p.darkGray,p.RED=p.red,p.PINK=p.pink,p.ORANGE=p.orange,p.YELLOW=p.yellow,p.GREEN=p.green,p.MAGENTA=p.magenta,p.CYAN=p.cyan,p.BLUE=p.blue;function r(t){if(this.isHTML="undefined"!=typeof window,this.isNode=!1,1!==arguments.length)throw"IllegalArgumentException";if("string"==typeof t||t instanceof String)this.pathname=t.replace(/\\/g,"/");else{if(!(t instanceof r))throw"IllegalArgumentException";this.pathname=t.getAbsolutePath()}}var n={parseCSV:function(t,e){arguments.length<2&&(e=","),t=t.replace(/\r\n?|\n/g,"\n");for(var i=e.charCodeAt(0),n=[],o=t.length,r="",s=0,h=0,l=!1,a=!1,u=0;u<o;u++){var p=t.charCodeAt(u);if(34===p&&0===r.length)for(u++;u<o;u++)if(34===(p=t.charCodeAt(u))){if(u+1===o-1)break;if(34!==t.charCodeAt(u+1))break;u++,r+='"'}else r+=t.charAt(u);else{switch(p){case i:l=!0;break;case 13:case 10:a=!0}l?(l=!1,void 0===n[s]&&(n[s]=[]),n[s][h]=r,r="",h+=1):a?(a=!1,""===r&&0===h||(void 0===n[s]&&(n[s]=[]),n[s][h]=r,r="",s+=1,h=0)):r+=t.charAt(u)}u===o-1&&0!==h&&(n[s][h]=r)}return n},makeCSV:function(t,e,i){arguments.length<2&&(e=","),arguments.length<3&&(i="\r\n");var n="",o=/["\r\n,\t]/;if(void 0!==t)for(var r=0;r<t.length;r++){if(void 0!==t[r])for(var s=0;s<t[r].length;s++){var h=t[r][s];o.test(h)&&(h='"'+(h=h.replace(/"/g,'""'))+'"'),n+=h,s!==t[r].length-1&&(n+=e)}n+=i}return n}};r.prototype.delete_=function(){throw"IllegalMethod"},r.prototype.exists=function(){throw"IllegalMethod"},r.prototype.copy=function(){throw"IllegalMethod"},r.prototype.move=function(){throw"IllegalMethod"},r.prototype.toString=function(){return this.getAbsolutePath()},r.prototype.getName=function(){if(this.isHTML){if(this.isDirectory())return"";var t=this.pathname.split("/");return t[t.length-1]}if(this.isNode)throw"IllegalMethod"},r.prototype.getParent=function(){var t=this.getAbsolutePath().match(/.*[/\\]/)[0];return t.substring(0,t.length-1)},r.prototype.getParentFile=function(){return new r(this.getParent())},r.prototype.getExtensionName=function(){if(this.isHTML){var t=this.getName().split(".");return t[t.length-1]}if(this.isNode)throw"IllegalMethod"},r.prototype.isAbsolute=function(){if(this.isHTML)return this.getAbsolutePath()===this.pathname;if(this.isNode)throw"IllegalMethod"},r.prototype.isDirectory=function(){if(this.isHTML)return/\/$/.test(this.pathname);if(this.isNode)throw"IllegalMethod"},r.prototype.isFile=function(){if(this.isHTML)return/[^/]$/.test(this.pathname);if(this.isNode)throw"IllegalMethod"},r.prototype.isHidden=function(){if(this.isNode)throw"IllegalMethod"},r.prototype.lastModified=function(){if(this.isNode)throw"IllegalMethod"},r.prototype.setLastModified=function(){if(this.isNode)throw"IllegalMethod"},r.prototype.length=function(){if(this.isNode)throw"IllegalMethod"},r.prototype.getFiles=function(){if(this.isNode)throw"IllegalMethod"},r.prototype.getSubFolders=function(){if(this.isNode)throw"IllegalMethod"},r.prototype.getNormalizedPathName=function(){if(""===this.pathname)return".\\";var t=this.pathname.replace(/\//g,"\\");return"\\"!==t.slice(-1)&&(t+="\\"),t},r.prototype.getAllFiles=function(){if(this.isNode)throw"IllegalMethod"},r.prototype.list=function(){if(this.isNode)throw"IllegalMethod"},r.prototype.getAbsolutePath=function(){if(this.isHTML){var t=null;if(/^http/.test(this.pathname))t=this.pathname;else{var e=window.location.toString();/\/$/.test(e)||(e=e.match(/.*\//)[0]),t=e+this.pathname}var i,n=t.match(/^http[^/]+\/\/[^/]+\//)[0],o=n,r=t.substr(n.length).split("/");for(i=0;i<r.length;i++)""!==r[i]&&"."!==r[i]&&(".."!==r[i]?(o+=r[i],i!==r.length-1&&(o+="/")):o=o.substring(0,o.length-1).match(/.*\//)[0]);return o}if(this.isNode)throw"IllegalMethod"},r.prototype.mkdir=function(){if(this.isNode)throw"IllegalMethod"},r.prototype.mkdirs=function(){if(this.isNode)throw"IllegalMethod"},r.prototype.renameTo=function(){if(this.isNode)throw"IllegalMethod"},r.prototype.run=function(){if(this.isNode)throw"IllegalMethod"},r.prototype.writeLine=function(){if(this.isNode)throw"IllegalMethod"},r.prototype.download=function(t){if(this.isHTML){var e=this.getExtensionName().toLocaleString(),i=this;if("gif"===e||"jpg"===e||"png"===e||"bmp"===e||"svg"===e||"jpeg"===e){var n=new Image;n.onload=function(){i.dataImage=n,t(i)},n.src=this.pathname}else{var o=r.createXMLHttpRequest();if(null===o)return null;o.onreadystatechange=function(){if(4===o.readyState){if(200!==o.status)return console.log("error downloadText "+i.pathname),null;i.dataText=o.responseText,t(i)}},o.open("GET",this.pathname,!0),o.send(null)}}else if(this.isNode)throw"IllegalMethod"},r.prototype.getImage=function(){if(this.isHTML)return this.dataImage},r.prototype.getText=function(){if(this.isHTML)return this.dataText;if(this.isNode)throw"IllegalMethod"},r.prototype.setText=function(){if(this.isNode)throw"IllegalMethod"},r.prototype.getCSV=function(t,e,i){if(this.isHTML)return n.parseCSV(this.dataText,t,i);if(this.isNode)throw"IllegalMethod"},r.prototype.setCSV=function(){if(this.isNode)throw"IllegalMethod"},r.prototype.getByte=function(){if(this.isNode)throw"IllegalMethod"},r.prototype.setByte=function(){if(this.isNode)throw"IllegalMethod"},r.createTempFile=function(){if("undefined"!=typeof window)throw"not createTempFile"},r.getCurrentDirectory=function(){if("undefined"!=typeof window)return new r("./").getParent()},r.setCurrentDirectory=function(){if("undefined"!=typeof window)throw"not setCurrentDirectory"},r.searchFile=function(){if("undefined"!=typeof window)throw"not searchFile"},r.downloadFileList=function(e,i,n){function t(t){return function(){r++,n&&n.length&&n[t]&&n[t](e[t]),r===e.length&&i&&i(e)}}var o,r=0;for(o=0;o<e.length;o++)e[o].download(t(o))},r.createXMLHttpRequest=function(){return new XMLHttpRequest},r.getCSVTool=function(){return n};function o(t){var e=arguments;if(this.map=[],this.size_=0,1===arguments.length){for(var i in t.map)this.map[i]=e[0].map[i];this.size_=t.size_}}o.prototype.each=function(t){var e=!0;for(var i in this.map){var n=this.map[i];if(!1===t.call(n,i,n)){e=!1;break}}return e},o.prototype.toString=function(){var t="",e=0;for(var i in this.map)t+=i+"=>"+this.map[i],++e!==this.size_&&(t+="\n");return t},o.prototype.containsKey=function(t){return void 0!==this.map[t]},o.prototype.containsValue=function(t){for(var e in this.map)if(this.map[e]===t)return!0;return!1},o.prototype.isEmpty=function(){return 0===this.size_},o.prototype.clear=function(){this.map=[],this.size_=0},o.prototype.clone=function(){var t=new o;for(var e in this.map)t.map[e]=this.map[e];return t.size_=this.size_,t},o.prototype.size=function(){return this.size_},o.prototype.get=function(t){return this.map[t]},o.prototype.put=function(t,e){if(!1===this.containsKey(t))return this.map[t]=e,this.size_=this.size_+1,null;var i=this.map[t];return this.map[t]=e,i},o.prototype.putAll=function(t){for(var e in t.map)void 0===this.map[e]&&(this.map[e]=t.map[e],this.size_=this.size_+1)},o.prototype.remove=function(t){if(!1===this.containsKey(t))return null;var e=this.map[t];return delete this.map[t],this.size_=this.size_-1,e};function t(){}function s(t){return"string"==typeof t||t instanceof String?0===t.length?" ":t:void 0===t?typeof t:null===t?"null":"function"==typeof t.toString?t.toString():t instanceof Object?"Object":"null"}function e(){this.output=e._getOutput()}var h=t.format=function(){function w(t){if(0<=t)return t;var e=~(t=-t)>>16&65535;return(e*=65536)+(65535&~t)+1}var b=1,S=arguments;return S[0].replace(/%[^diubBoxXeEfFgGaAcspn%]*[diubBoxXeEfFgGaAcspn%]/g,function(t){var e,i=(e=(t=t.substring(1,t.length)).match(/.$/))[0];if("%"===i)return"%";null!==(e=t.match(/^[0-9]+\$/))&&(e=e[0],t=t.substring(e.length,t.length),e=e.substring(0,e.length-1),b=parseInt(e,10));var n=S[b];b+=1;var o=!1,r=!1,s=!1,h="";null!==(e=t.match(/^[-+ #0]+/))&&(e=e[0],t=t.substring(e.length,t.length),-1!==e.indexOf("#")&&(o=!0),-1!==e.indexOf("-")&&(r=!0),-1!==e.indexOf(" ")&&(h=" "),-1!==e.indexOf("+")&&(h="+"),-1!==e.indexOf("0")&&(s=!0));var l=0;null!==(e=t.match(/^([0-9]+|\*)/))&&(e=e[0],t=t.substring(e.length,t.length),-1!==e.indexOf("*")?(l=n,n=S[b],b+=1):l=parseInt(e,10));var a=!1,u=0;null!==(e=t.match(/^(\.((-?[0-9]+)|\*)|\.)/))&&(e=e[0],t=t.substring(e.length,t.length),a=!0,-1!==e.indexOf("*")?(u=n,n=S[b],b+=1):u=1===e.length?0:(e=e.substring(1,e.length),parseInt(e,10))),null!==(e=t.match(/^hh|h|ll|l|L|z|j|t/))&&(t=t.substring(e.length,t.length));var p="",c=!1;switch(i.toLowerCase()){case"d":case"i":case"u":case"b":case"o":case"x":c=!0;case"e":case"f":case"g":var d,g="";switch(c?(isNaN(n)&&(n=parseInt(n,10)),n="d"===i||"i"===i?(n<0&&(h="-",n=-n),Math.floor(n)):0<=n?Math.floor(n):Math.ceil(n)):(isNaN(n)&&(n=parseFloat(n)),n<0&&(h="-",n=-n),a||(u=6)),i.toLowerCase()){case"d":case"i":p+=n.toString(10);break;case"u":p+=w(n).toString(10);break;case"b":p+=w(n).toString(2),o&&(g="0b");break;case"o":p+=w(n).toString(8),o&&(g="0");break;case"x":case"X":p+=w(n).toString(16),o&&(g="0x");break;case"e":p+=n.toExponential(u);break;case"f":p+=n.toFixed(u);break;case"g":0===u&&(u=1),p+=n.toPrecision(u),o||-1===p.indexOf(".")||(p=(p=p.replace(/\.?0+$/,"")).replace(/\.?0+e/,"e"))}if(c){if(a){d=u-p.length;for(var f=0;f<d;f++)p="0"+p}}else o&&-1===p.indexOf(".")&&(-1!==p.indexOf("e")?p=p.replace("e",".e"):p+=".");if(-1!==p.indexOf("e")){p=p.replace(/e[+-][0-9]{1,2}$/,function(t){var e=t.length;return 3===t.length?t.substring(0,e-1)+"00"+t.substring(e-1,e):t.substring(0,e-2)+"0"+t.substring(e-2,e)})}if(d=l-(p.length+g.length+h.length),r)for(var m=0;m<d;m++)p+=" ";if(s)for(var y=0;y<d;y++)p="0"+p;if(p=h+(p=g+p),!s&&!r)for(var E=0;E<d;E++)p=" "+p;i.toUpperCase()===i&&(p=p.toUpperCase());break;case"c":isNaN(n)||(n=String.fromCharCode(n));case"s":isNaN(n)||(n=n.toString(10)),p=n,a&&p.length>u&&(p=p.substring(0,u));var v=l-p.length;if(r)for(var M=0;M<v;M++)p+=" ";else for(var _=s?"0":" ",C=0;C<v;C++)p=_+p;break;case"%":p="%";break;case"p":case"n":p="(変換できません)"}return p})};e._getOutput=function(){function t(){return"undefined"!=typeof WSH?null:"undefined"!=typeof console?console:"undefined"!=typeof window&&void 0!==window.console?window.console:null}var e=null;if("undefined"!=typeof WSH)e=/cscript\.exe$/i.test(WSH.FullName)?function(t){/\n$/.test(t)?WSH.StdOut.Write(t):WSH.StdOut.Write(t+"\n")}:WScript.Echo;else if(null!==t()){e=t().log}else"undefined"!=typeof alert&&(e=alert);return e},e.prototype.getOutput=function(){return this.output};function l(){this.root=null,this.element=null,this.isshow=!1,this.loglength=250,this.linelength=0}l.prototype._getElement=function(){if(null!==this.element)return this.element;var t=document.createElement("div");return t.style.backgroundColor="black",t.style.color="white",t.style.display="block",t.style.margin="0px",t.style.padding="5px",t.style.fontFamily="Consolas, Courier New, Courier, Monaco, monospace",t.style.whiteSpace="pre",this.element=t,this.element},l.prototype._initHTML=function(){if(null===this.root){var t;if(t=document.getElementById("senko_console"))for(var e=t.lastChild;e;)t.removeChild(e),e=t.lastChild;else t=document.body;t.style.backgroundColor="black",t.style.margin="0px",t.style.padding="0px",t.style.overflowY="scroll",t.appendChild(this._getElement()),this.root=t}},l.prototype.isShow=function(){return this.isshow},l.prototype.setShow=function(t){if("boolean"!=typeof t)throw"not boolean";this._initHTML();var e=this._getElement();this.isshow!==t&&(this.isshow=t,e&&(e.style.display=this.isshow?"block":"none"))},l.prototype._autoScroll=function(){if(null!==this.element&&null!==this.root){var t=this.root.clientHeight,e=this.element.clientHeight;e-t-1*t<=this.root.scrollTop&&(this.root.scrollTop=e)}},l.prototype._addNewLine=function(){this._initHTML();var t=this._getElement(),e=document.createElement("p");e.innerText="> ",e.style.margin="0.2em 0px 0.2em 0px",e.style.padding="0px",t.appendChild(e),this.linelength++,this._cleaningLog()},l.prototype._appendText=function(t){this._initHTML();var e=this._getElement().lastElementChild;e.innerText=e.innerText+t},l.prototype._cleaningLog=function(){if(null!==this.element)for(;this.linelength>this.loglength;)this.element.removeChild(this.element.firstElementChild),this.linelength--},l.prototype.setLogLength=function(t){this.loglength=t},l.prototype.println=function(t){this._initHTML();var e=this._getElement();e&&(e.lastElementChild||this._addNewLine(),this._appendText(t),this._addNewLine()),this._autoScroll()};var a=(new e).getOutput(),u=null,c=null;(console||window&&window.console)&&(u=new l,c=function(t){u.println(t)});function d(){}var g=!1,f="";d.setGUI=function(){c&&(g=!0)},d.setCUI=function(){g=!1},d.println=function(t){var e=f+s(t);f="",g?c(e):a(e)},d.print=function(t){f+=s(t)},d.printf=function(){for(var t=arguments,e=[],i=0;i<arguments.length;i++)e.push(t[i]);d.print(h.apply(this,e))};function m(){}m.removeComment=function(t){for(var e=!1,i=!1,n=!1,o=!1,r=!1,s=!1,h=[],l=0;l<t.length;l++){var a=t.charAt(l);if(e)i?i=!1:"\\"===a?i=!0:'"'===a&&(e=!1),h[h.length]=a;else if(r)s&&(s=!1,"/"===a&&(r=!1)),"*"===a?s=!0:"\n"===a&&(h[h.length]=a);else if(o)"\n"===a&&(o=!1,h[h.length]=a);else{if(n){if(n=!1,"/"===a){o=!0,h[h.length-1]="";continue}if("*"===a){r=!0,h[h.length-1]="";continue}}'"'===a&&(e=!0),"/"===a&&(n=!0),h[h.length]=a}}return h.join("")};function y(){this._initIDSwitch()}y.prototype._initIDSwitch=function(){this.istyped=!1,this.ispressed=!1,this.isreleased=!1,this.pressed_time=0},y.prototype.clone=function(){var t=new y;return t.istyped=this.istyped,t.ispressed=this.ispressed,t.isreleased=this.isreleased,t.pressed_time=this.pressed_time,t},y.prototype.keyPressed=function(){this.ispressed||(this.istyped=!0),this.ispressed=!0,this.pressed_time++},y.prototype.keyReleased=function(){this.ispressed=!1,this.isreleased=!0,this.pressed_time=0},y.prototype.focusLost=function(){this.keyReleased()},y.prototype.pickInput=function(t){if(!(t instanceof y))throw"IllegalArgumentException";t.ispressed=this.ispressed,t.istyped=this.istyped,t.isreleased=this.isreleased,t.pressed_time=this.pressed_time,this.isreleased=!1,this.istyped=!1};function E(t,e){this._initIDPosition(t,e)}E.prototype._initIDPosition=function(t,e){if(t instanceof E){var i=t;this.set(i)}else void 0===t?(this.x=0,this.y=0):2===arguments.length?this.set(t,e):(this.x=0,this.y=0)},E.prototype.clone=function(){return new E(this)},E.prototype.set=function(t,e){if(t instanceof E){var i=t;this.x=i.x,this.y=i.y}else this.x=t,this.y=e},E.prototype.add=function(t,e){if(t instanceof E){var i=t;this.x+=i.x,this.y+=i.y}else this.x+=t,this.y+=e},E.prototype.sub=function(t,e){if(t instanceof E){var i=t;this.x-=i.x,this.y-=i.y}else this.x-=t,this.y-=e},E.norm=function(t,e){var i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)};function v(t){this._initIDDraggableSwitch(t)}v.prototype._initIDDraggableSwitch=function(t){this.mask=t,this.switch=new y,this.client=new E,this.deltaBase=new E,this.dragged=new E},v.prototype.clone=function(){var t=new v;return t.mask=this.mask,t.switch=this.switch.clone(),t.client=this.client.clone(),t.deltaBase=this.deltaBase.clone(),t.dragged=this.dragged.clone(),t},v.prototype.correctionForDOM=function(t){var e=t.target;return void 0===(e=e||t.currentTarget)?new E(t.clientX,t.clientY):new E(t.clientX/e.clientWidth*e.width,t.clientY/e.clientHeight*e.height)},v.prototype.setPosition=function(t){var e=this.correctionForDOM(t);this.client.set(e),this.deltaBase.set(e),this.dragged._initIDPosition()},v.prototype.mousePressed=function(t){var e=this.correctionForDOM(t);t.button===this.mask&&(this.switch.ispressed||this.dragged._initIDPosition(),this.switch.keyPressed(),this.client.set(e),this.deltaBase.set(e))},v.prototype.mouseReleased=function(t){t.button===this.mask&&this.switch.ispressed&&this.switch.keyReleased()},v.prototype.mouseMoved=function(t){var e=this.correctionForDOM(t);if(this.switch.ispressed){var i=new E(e);i.sub(this.deltaBase),this.dragged.add(i)}this.client.set(e.x,e.y),this.deltaBase.set(e.x,e.y)},v.prototype.focusLost=function(){this.switch.focusLost()},v.prototype.pickInput=function(t){if(!(t instanceof v))throw"IllegalArgumentException";this.switch.pickInput(t.switch),t.client.set(this.client),t.dragged.set(this.dragged),this.dragged._initIDPosition()};function M(){this._initIDMouse()}M.prototype._initIDMouse=function(){this.left=new v(M.MOUSE_EVENTS.BUTTON1_MASK),this.center=new v(M.MOUSE_EVENTS.BUTTON2_MASK),this.right=new v(M.MOUSE_EVENTS.BUTTON3_MASK),this.position=new E,this.wheelrotation=0},M.prototype.clone=function(){var t=new M;return t.left=this.left.clone(),t.center=this.center.clone(),t.right=this.right.clone(),t.position=this.position.clone(),t.wheelrotation=this.wheelrotation,t},M.prototype.mousePressed=function(t){this.left.mousePressed(t),this.center.mousePressed(t),this.right.mousePressed(t)},M.prototype.mouseReleased=function(t){this.left.mouseReleased(t),this.center.mouseReleased(t),this.right.mouseReleased(t)},M.prototype.mouseMoved=function(t){this.left.mouseMoved(t),this.center.mouseMoved(t),this.right.mouseMoved(t),this.position.x=this.left.client.x,this.position.y=this.left.client.y},M.prototype.mouseWheelMoved=function(t){0!==t.wheelDelta&&(this.wheelrotation+=0<t.deltaY?-1:1)},M.prototype.focusLost=function(){this.left.focusLost(),this.center.focusLost(),this.right.focusLost()},M.prototype.pickInput=function(t){if(!(t instanceof M))throw"IllegalArgumentException";this.left.pickInput(t.left),this.center.pickInput(t.center),this.right.pickInput(t.right),t.position.set(this.position),t.wheelrotation=this.wheelrotation,this.wheelrotation=0},M.prototype.setListenerOnElement=function(t){var e=this;t.style.cursor="crosshair",t.style.mozUserSelect="none",t.style.webkitUserSelect="none",t.style.msUserSelect="none",t.style.webkitTouchCallout="none",t.style.webkitTapHighlightColor="rgba(0,0,0,0)",t.addEventListener("mousedown",function(t){e.mousePressed(t)},!1),t.addEventListener("mouseup",function(t){e.mouseReleased(t)},!1),t.addEventListener("mousemove",function(t){e.mouseMoved(t)},!1),t.addEventListener("mouseout",function(){e.focusLost()},!1),t.addEventListener("wheel",function(t){e.mouseWheelMoved(t),t.preventDefault()},!1),t.addEventListener("contextmenu",function(t){t.preventDefault()},!1)},M.MOUSE_EVENTS={BUTTON1_MASK:0,BUTTON2_MASK:1,BUTTON3_MASK:2};function _(t){this.blendfunc=b.brendNone,1===arguments.length&&this.setBlendMode(t)}var C=function(r){function t(){r.call(this),this._initIDTouch()}return r&&(t.__proto__=r),((t.prototype=Object.create(r&&r.prototype)).constructor=t).prototype._initIDTouch=function(){this.touchcount_to_mask={1:r.MOUSE_EVENTS.BUTTON1_MASK,2:r.MOUSE_EVENTS.BUTTON3_MASK,3:r.MOUSE_EVENTS.BUTTON2_MASK};var e=this;this._mousePressed=function(t){e.mousePressed(t)},this._mouseReleased=function(t){e.mouseReleased(t)},this._mouseMoved=function(t){e.mouseMoved(t)},this.isdoubletouch=!1},t.prototype._initPosition=function(t){this.left.setPosition(t),this.right.setPosition(t),this.center.setPosition(t)},t.prototype._MultiTouchToMouse=function(t){for(var e=0,i=0,n=0;n<t.touches.length;n++)e+=t.touches[n].clientX,i+=t.touches[n].clientY;var o={};if(0<t.touches.length){o.clientX=e/t.touches.length,o.clientY=i/t.touches.length,o.button=this.touchcount_to_mask[t.touches.length];var r=t.touches[0];o.target=r.target?r.target:r.currentTarget}else o.clientX=0,o.clientY=0,o.button=0;return o.touchcount=t.touches.length,o},t.prototype._MoveMultiTouch=function(t){if(2===t.touches.length){var e=t.touches[0],i=t.touches[1];if(!1===this.isdoubletouch)this.isdoubletouch=!0,this.doubleposition=[],this.doubleposition[0]=new E(e.clientX,e.clientY),this.doubleposition[1]=new E(i.clientX,i.clientY);else{var n=new E(e.clientX,e.clientY),o=new E(i.clientX,i.clientY),r=E.norm(this.doubleposition[0],this.doubleposition[1])-E.norm(n,o);this.doubleposition[0]=n,this.doubleposition[1]=o;var s=Math.abs(r)<10?.01*Math.abs(r):.5;this.wheelrotation+=(0<r?-1:1)*s}}else this.isdoubletouch},t.prototype._actFuncMask=function(t,e,i,n){for(var o in r.MOUSE_EVENTS)t.button=r.MOUSE_EVENTS[o],r.MOUSE_EVENTS[o]===n?e(t):i(t)},t.prototype.touchStart=function(t){var e=this._MultiTouchToMouse(t);this._initPosition(e),this._actFuncMask(e,this._mousePressed,this._mouseReleased,e.button)},t.prototype.touchEnd=function(t){var e=this._MultiTouchToMouse(t);this._actFuncMask(e,this._mouseReleased,this._mouseReleased,e.button)},t.prototype.touchMove=function(t){this._MoveMultiTouch(t);var e=this._MultiTouchToMouse(t);this._actFuncMask(e,this._mouseMoved,this._mouseMoved,e.button)},t.prototype.setListenerOnElement=function(t){r.prototype.setListenerOnElement.call(this,t);function e(t){i.touchEnd(t)}var i=this;t.addEventListener("touchstart",function(t){i.touchStart(t)},!1),t.addEventListener("touchend",e,!1),t.addEventListener("touchmove",function(t){i.touchMove(t),t.preventDefault()},!1),t.addEventListener("touchcancel",e,!1)},t}(M),w={DraggableSwitch:v,Mouse:M,Position:E,Switch:y,Touch:C,Tools:{noScroll:function(){window.addEventListener("load",function(){document.body.style.height="100%",document.body.style.overflow="hidden",document.documentElement.height="100%",document.documentElement.overflow="hidden"},!1)}}},b={ipLerp:function(t,e,i){var n=e.subColor(t);return t.addColor(n.mul(i))},brendNone:function(t,e,i){return e},brendAlpha:function(t,e,i){var n=t.getBlendAlpha(),o=e.getBlendAlpha()*i;return(t=b.ipLerp(t,e,o)).setBlendAlpha(Math.max(n,o))},brendAdd:function(t,e,i){var n=t.getBlendAlpha(),o=e.getBlendAlpha()*i;return(t=t.addColor(e.mul(o))).setBlendAlpha(Math.max(n,o))},brendSub:function(t,e,i){var n=t.getBlendAlpha(),o=e.getBlendAlpha()*i;return(t=t.subColor(e.mul(o))).setBlendAlpha(n)},brendRevSub:function(t,e,i){var n=e.getBlendAlpha(),o=t.getBlendAlpha()*i;return(e=e.subColor(t.mul(o))).setBlendAlpha(n)},brendMul:function(t,e,i){var n=t.getBlendAlpha(),o=e.getBlendAlpha()*i;return(t=t.mulColor(e.mul(o).div(255))).setBlendAlpha(n)}};_.prototype.clone=function(){return new _(this.blendmode)},_.prototype.setBlendMode=function(t){(this.blendmode=t)===_.MODE.NONE?this.blendfunc=b.brendNone:t===_.MODE.ALPHA?this.blendfunc=b.brendAlpha:t===_.MODE.ADD?this.blendfunc=b.brendAdd:t===_.MODE.SUB?this.blendfunc=b.brendSub:t===_.MODE.REVSUB?this.blendfunc=b.brendRevSub:t===_.MODE.MUL&&(this.blendfunc=b.brendMul)},_.prototype.blend=function(t,e,i){return this.blendfunc(t,e,i)},_.MODE={NONE:"NONE",ALPHA:"ALPHA",ADD:"ADD",SUB:"SUB",REVSUB:"REVSUB",MUL:"MUL"};function S(){}S.prototype.getColor=function(){return null},S.prototype.clone=function(){return null},S.prototype.zero=function(){return null},S.prototype.one=function(){return null},S.prototype.add=function(){return null},S.prototype.sub=function(){return null},S.prototype.mul=function(){return null},S.prototype.div=function(){return null},S.prototype.exp=function(){return null},S.prototype.log=function(){return null},S.prototype.pow=function(){return null},S.prototype.baselog=function(){return null},S.prototype.table=function(){return null},S.prototype.random=function(){return null},S.prototype.luminance=function(){return null},S.prototype.addColor=function(){return null},S.prototype.subColor=function(){return null},S.prototype.mulColor=function(){return null},S.prototype.divColor=function(){return null},S.prototype.maxColor=function(){return null},S.prototype.minColor=function(){return null},S.prototype.norm=function(){return null},S.prototype.normFast=function(){return null},S.prototype.normColor=function(t,e){return this.subColor(t).norm(e)},S.prototype.normColorFast=function(t,e){return this.subColor(t).normFast(e)},S.prototype.getBlendAlpha=function(){return null},S.prototype.setBlendAlpha=function(){return null},S.prototype.exchangeColorAlpha=function(){return null},S.prototype.equals=function(){return!1},S.prototype.searchColor=function(t,e){for(var i=0,n=2147483647,o=null,r=2147483646,s=null,h=0;h<t.length;h++)(i=this.normColorFast(t[h],e))<r&&(i<n?(r=n,s=o,n=i,o=t[h]):(r=i,s=t[h]));return{c1:{color:o,norm:n},c2:{color:s,norm:r}}},S.NORM_MODE={MANHATTEN:0,EUGRID:1};function N(t,e){2===arguments.length?this.setSize(t,e):this.setSize(0,0)}N.prototype.clone=function(){return new N(this.width,this.height)},N.prototype.setSize=function(t,e){this.width=t,this.height=e},N.prototype.getPixelPosition=function(t,e){return t=~~Math.floor(t),e=~~Math.floor(e),0<=t&&0<=e&&t<this.width&&e<this.height?[t,e]:null};function x(t,e,i){this.width=1,this.height=1,2<=arguments.length&&(this.width=e,this.height=i),3==arguments.length?this.setImgWrapMode(t):this.setImgWrapMode(x.MODE.INSIDE)}var I=function(i){function t(t,e){i.call(this,t,e)}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.clone=function(){return new t(this.width,this.height)},t.prototype.getPixelPosition=function(t,e){return t=~~Math.floor(t),e=~~Math.floor(e),0<=t&&0<=e&&t<this.width&&e<this.height?[t,e]:[t=~~Math.floor(Math.min(Math.max(0,t),this.width-1)),e=~~Math.floor(Math.min(Math.max(0,e),this.height-1))]},t}(N),A=function(i){function t(t,e){i.call(this,t,e)}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.clone=function(){return new t(this.width,this.height)},t.prototype.getPixelPosition=function(t,e){if(t=~~Math.floor(t),e=~~Math.floor(e),0<=t&&0<=e&&t<this.width&&e<this.height)return[t,e];var i=Math.floor(t/this.width),n=Math.floor(e/this.height);return t-=Math.floor(this.width*i),e-=Math.floor(this.height*n),t<0&&(t+=this.width),e<0&&(e+=this.height),[t,e]},t}(N);x.prototype.clone=function(){return new x(this.wrapmode,this.width,this.height)},x.prototype.setImgWrapMode=function(t){(this.wrapmode=t)===x.MODE.INSIDE?this.wrap=new N(this.width,this.height):t===x.MODE.CLAMP?this.wrap=new I(this.width,this.height):t===x.MODE.REPEAT&&(this.wrap=new A(this.width,this.height))},x.prototype.setSize=function(t,e){this.width=t,this.height=e,this.wrap&&this.wrap.setSize(t,e)},x.prototype.getPixelPosition=function(t,e){return this.wrap.getPixelPosition(t,e)},x.MODE={INSIDE:"INSIDE",CLAMP:"CLAMP",REPEAT:"REPEAT"};function O(t){0===arguments.length&&(t=O.MODE.NEAREST_NEIGHBOR),this.setInterpolationMode(t)}var L={ipLerp:function(t,e,i){var n=e.subColor(t);return t.addColor(n.mul(i))},ipCosine:function(t,e,i){return L.ipLerp(t,e,.5*(1-Math.cos(Math.PI*i)))},ipHermite2p3:function(t,e,i){return L.ipLerp(t,e,i*i*(3-2*i))},ipHermite2p5:function(t,e,i){return L.ipLerp(t,e,i*i*i*(6*i*i-15*i+10))},ipHermite4p:function(t,e,i,n,o){var r=n.subColor(i).subColor(t.subColor(e)),s=t.subColor(e).subColor(r),h=i.subColor(t),l=e;return r.mul(o*o*o).addColor(s.mul(o*o)).addColor(h.mul(o)).addColor(l)},funcInBicubic:function(t,e){return t<=1?1-(e+3)*t*t+(e+2)*t*t*t:-4*e+8*e*t-5*e*t*t+e*t*t*t},ipBicubic:function(t,e,i,n,o,r){var s=L.funcInBicubic(o+1,r),h=L.funcInBicubic(o,r),l=L.funcInBicubic(1-o,r),a=L.funcInBicubic(2-o,r);return t.mul(s).addColor(e.mul(h)).addColor(i.mul(l)).addColor(n.mul(a)).mul(1/(s+h+l+a))},ipBicubicSoft:function(t,e,i,n,o){return L.ipBicubic(t,e,i,n,o,-.5)},ipBicubicNormal:function(t,e,i,n,o){return L.ipBicubic(t,e,i,n,o,-1)},ipBicubicSharp:function(t,e,i,n,o){return L.ipBicubic(t,e,i,n,o,-1.2)},ipBicubic2D:function(t,e,i,n){var o,r,s,h,l=t[0][0].zero(),a=0;for(r=0;r<4;r++)for(s=L.funcInBicubic(Math.abs(-i+r-1),n),o=0;o<4;o++)h=L.funcInBicubic(Math.abs(-e+o-1),n),a+=h*=s,l=l.addColor(t[r][o].mul(h));return l=l.mul(1/a)},ipBicubic2DSoft:function(t,e,i){return L.ipBicubic2D(t,e,i,-.5)},ipBicubic2DNormal:function(t,e,i){return L.ipBicubic2D(t,e,i,-1)},ipBicubic2DSharp:function(t,e,i){return L.ipBicubic2D(t,e,i,-1.2)}};O.prototype.clone=function(){return new O(this.ipmode)},O.prototype.setInterpolationMode=function(t){(this.ipmode=t)===O.MODE.NEAREST_NEIGHBOR?(this.ipfunc=L.ipLerp,this.ipn=1):t===O.MODE.BILINEAR?(this.ipfunc=L.ipLerp,this.ipn=2):t===O.MODE.COSINE?(this.ipfunc=L.ipCosine,this.ipn=2):t===O.MODE.HERMITE4_3?(this.ipfunc=L.ipHermite2p3,this.ipn=2):t===O.MODE.HERMITE4_5?(this.ipfunc=L.ipHermite2p5,this.ipn=2):t===O.MODE.HERMITE16?(this.ipfunc=L.ipHermite4p,this.ipn=4):t===O.MODE.BICUBIC?(this.ipfunc=L.ipBicubic2DNormal,this.ipn=16):t===O.MODE.BICUBIC_SOFT?(this.ipfunc=L.ipBicubicSoft,this.ipn=4):t===O.MODE.BICUBIC_NORMAL?(this.ipfunc=L.ipBicubicNormal,this.ipn=4):t===O.MODE.BICUBIC_SHARP&&(this.ipfunc=L.ipBicubicSharp,this.ipn=4)},O.prototype.getColor=function(t,e,i){var n=Math.floor(e),o=Math.floor(i);if(1===this.ipn||n===e&&o===i)return t.getPixel(n,o);if(2===this.ipn){var r,s,h=e-n,l=i-o;r=t.getPixel(n,o),s=t.getPixel(n+1,o);var a=this.ipfunc(r,s,h);r=t.getPixel(n,o+1),s=t.getPixel(n+1,o+1);var u=this.ipfunc(r,s,h);return this.ipfunc(a,u,l)}if(4===this.ipn){var p,c,d,g,f=e-n,m=i-o;p=t.getPixel(n-1,o-1),c=t.getPixel(n,o-1),d=t.getPixel(n+1,o-1),g=t.getPixel(n+2,o-1);var y=this.ipfunc(p,c,d,g,f);p=t.getPixel(n-1,o),c=t.getPixel(n,o),d=t.getPixel(n+1,o),g=t.getPixel(n+2,o);var E=this.ipfunc(p,c,d,g,f);p=t.getPixel(n-1,o+1),c=t.getPixel(n,o+1),d=t.getPixel(n+1,o+1),g=t.getPixel(n+2,o+1);var v=this.ipfunc(p,c,d,g,f);p=t.getPixel(n-1,o+2),c=t.getPixel(n,o+2),d=t.getPixel(n+1,o+2),g=t.getPixel(n+2,o+2);var M=this.ipfunc(p,c,d,g,f);return this.ipfunc(y,E,v,M,m)}if(16!==this.ipn)return null;var _,C,w=e-n,b=i-o,S=[];for(C=-1;C<3;C++){var N=[];for(_=-1;_<3;_++)N[N.length]=t.getPixel(n+_,o+C);S[S.length]=N}return this.ipfunc(S,w,b)},O.MODE={NEAREST_NEIGHBOR:"NEAREST_NEIGHBOR",BILINEAR:"BILINEAR",COSINE:"COSINE",HERMITE4_3:"HERMITE4_3",HERMITE4_5:"HERMITE4_5",HERMITE16:"HERMITE16",BICUBIC:"BICUBIC",BICUBIC_SOFT:"BICUBIC_SOFT",BICUBIC_NORMAL:"BICUBIC_NORMAL",BICUBIC_SHARP:"BICUBIC_SHARP"};function P(t){var e;for(this.height=t.length,this.width=t[0].length,this.matrix=[],e=0;e<t.length;e++)this.matrix[e]=t[e].slice()}P.prototype.clone=function(){return new P(this.matrix)},P.prototype.rotateEdge=function(t){var e,i,n=this.clone(),o=[],r=[];for(e=0;e<this.width-1;e++)o.push(n.matrix[0][e]);for(e=0;e<this.height-1;e++)o.push(n.matrix[e][this.width-1]);for(e=this.width-1;0<e;e--)o.push(n.matrix[this.height-1][e]);for(e=this.height-1;0<e;e--)o.push(n.matrix[e][0]);for(e=0;e<o.length;e++)r[e]=o[((e+t)%o.length+o.length)%o.length];for(n.matrix[0]=r.slice(0,this.width),e=0;e<this.height;e++)n.matrix[e][this.width-1]=r[this.width+e];for(n.matrix[this.height-1]=r.slice(this.width+this.height-2,this.width+this.height-2+this.width).reverse(),e=this.height-1,i=0;0<e;e--,i++)n.matrix[e][0]=r[this.width+this.height+this.width-3+i];return n},P.prototype.mul=function(t){var e,i,n=this.clone();for(i=0;i<n.height;i++)for(e=0;e<n.width;e++)n.matrix[i][e]*=t;return n},P.prototype.sum=function(){var t,e,i=0;for(e=0;e<this.height;e++)for(t=0;t<this.width;t++)i+=this.matrix[e][t];return i},P.prototype.normalize=function(){return this.clone().mul(1/this.sum())},P.prototype.addCenter=function(t){var e=this.clone();return e.matrix[e.height>>1][e.width>>1]+=t,e},P.makeLaplacianFilter=function(){return new P([[0,-1,0],[-1,4,-1],[0,-1,0]])},P.makeSharpenFilter=function(t){return P.makeLaplacianFilter().mul(t).addCenter(1)},P.makeBlur=function(t,e){var i,n,o=[],r=1/(t*e);for(n=0;n<e;n++)for(o[n]=[],i=0;i<t;i++)o[n][i]=r;return new P(o)},P.makeGaussianFilter=function(t,e,i){void 0===i&&(i=1);var n,o,r,s=[],h=[],l=Math.max(t,e),a=-Math.floor(l/2);for(n=0;n<l;n++,a++)h[n]=Math.exp(-a*a/(i*i*2));for(r=0;r<e;r++)for(s[r]=[],o=0;o<t;o++)s[r][o]=h[o]*h[r];return new P(s).normalize()},P.makeCircle=function(t){var e,i,n=[],o=.5*t,r=t>>1;for(i=0;i<t;i++)for(n[i]=[],e=0;e<t;e++)Math.sqrt((r-e)*(r-e)+(r-i)*(r-i))<o?n[i][e]=1:n[i][e]=0;return new P(n).normalize()};function T(t,e){if(this.width=1,this.height=1,this.globalAlpha=1,this.data=null,this.blend=new _(_.MODE.NONE),this.wrap=new x(x.MODE.INSIDE,this.width,this.height),this.ip=new O(O.MODE.NEAREST_NEIGHBOR),1===arguments.length){var i=t;this.putImageData(i)}else if(2===arguments.length){var n=t,o=e;this.setSize(n,o)}}T.prototype.putImageData=function(t){},T.prototype.setSize=function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.wrap.setSize(t,e))},T.prototype._copyData=function(t){t.blend=this.blend.clone(),t.wrap=this.wrap.clone(),t.ip=this.ip.clone(),t.setSize(this.width,this.height),t.data.set(this.data),t.globalAlpha=this.globalAlpha},T.prototype.clone=function(){var t=new T;return this._copyData(t),t},T.prototype.setWrapMode=function(t){this.wrap.setImgWrapMode(t)},T.prototype.getWrapMode=function(){return this.wrap.wrapmode},T.prototype.setInterpolationMode=function(t){this.ip.setInterpolationMode(t)},T.prototype.getInterpolationMode=function(){return this.ip.ipmode},T.prototype.setBlendType=function(t){this.blend.setBlendMode(t)},T.prototype.getBlendType=function(){return this.blend.blendmode},T.prototype.clear=function(){this.data&&this.data.fill(0)},T.prototype.getPixelInside=function(t,e){return null},T.prototype.setPixelInside=function(t,e,i){},T.prototype.getPixel=function(t,e){var i=this.wrap.getPixelPosition(t,e);return i?this.getPixelInside(i[0],i[1]):this.getPixelInside(0,0).zero()},T.prototype.setPixel=function(t,e,i){var n=this.wrap.getPixelPosition(t,e);if(n)if(this._blendtype===T.MODE_BLEND.NONE)this.setPixelInside(n[0],n[1],i);else{var o=this.getPixelInside(n[0],n[1]),r=this.blend.blend(o,i,this.globalAlpha);this.setPixelInside(n[0],n[1],r)}},T.prototype.getColor=function(t,e){return this.ip.getColor(this,t,e)},T.prototype.getColorUV=function(t,e){return this.getColor(t*this.width,e*this.height)},T.prototype.setColor=function(t,e,i){this.setPixel(Math.floor(t),Math.floor(e),i)},T.prototype.drawImgData=function(t,e,i,n,o,r,s,h,l){if(!(t instanceof T))throw"IllegalArgumentException";if(3===arguments.length)r=e,s=i,h=t.width,l=t.height,i=e=0,n=t.width,o=t.height;else if(5===arguments.length)r=e,s=i,h=n,l=o,i=e=0,n=t.width,o=t.height;else if(9!==arguments.length)throw"IllegalArgumentException";var a,u,p,c,d=n/h,g=o/l;for(u=i,c=s;c<s+l;c++){for(a=e,p=r;p<r+h;p++){var f=t.getColor(a,u);f&&this.setColor(p,c,f),a+=d}u+=g}},T.prototype.forEach=function(t){for(var e=0,i=0;i<this.height;i++)for(e=0;e<this.width;e++)t(this.getPixelInside(e,i),e,i,this)},T.prototype.convolution=function(t){if(!(t instanceof P))throw"IllegalArgumentException";var e,i,n,o,r,s,h=-(t.width>>1),l=-(t.height>>1),a=t.matrix,u=this.getPixelInside(0,0).zero(),p=this.clone();for(i=0;i<this.height;i++)for(e=0;e<this.width;e++){var c=u;for(o=i+l,s=0;s<t.height;s++,o++)for(n=e+h,r=0;r<t.width;r++,n++){var d=p.getPixel(n,o);d&&(c=c.addColor(d.mul(a[s][r])))}this.setPixelInside(e,i,c)}},T.prototype.convolutionBilateral=function(t,e){if(!(t instanceof P))throw"IllegalArgumentException";var i,n,o,r,s,h;void 0===e&&(e=.8);var l=-(t.width>>1),a=-(t.height>>1),u=t.matrix,p=this.getPixelInside(0,0).zero(),c=this.clone(),d=.01*-(1-e)-.001,g=[];for(i=0;i<768;i++)g[i]=Math.exp(i*i*d);for(n=0;n<this.height;n++)for(i=0;i<this.width;i++){var f=c.getPixel(i,n),m=f.getBlendAlpha(),y=0,E=p,v=[];for(r=n+a,h=0;h<t.height;h++,r++)for(o=i+l,v[h]=[],s=0;s<t.width;s++,o++){var M=c.getPixel(o,r);if(M){var _=g[Math.floor(M.normColor(f,S.NORM_MODE.EUGRID))]*u[h][s];E=E.addColor(M.mul(_)),y+=_}}E=E.div(y).setBlendAlpha(m),this.setPixelInside(i,n,E)}},T.prototype.convolutionExp=function(t,e){if(!(t instanceof P))throw"IllegalArgumentException";var i,n,o,r,s,h;void 0===e&&(e=1.2);var l=-(t.width>>1),a=-(t.height>>1),u=t.matrix,p=this.getPixelInside(0,0).zero(),c=this.clone(),d=[];for(i=0;i<256;i++)d[i]=Math.pow(e,i);for(n=0;n<this.height;n++)for(i=0;i<this.width;i++){var g=p;for(r=n+a,h=0;h<t.height;h++,r++)for(o=i+l,s=0;s<t.width;s++,o++){var f=c.getPixel(o,r);f&&(g=g.addColor(f.table(d).mul(u[h][s])))}this.setPixelInside(i,n,g.baselog(e))}},T.prototype.convolutionUnSharp=function(t,e){if(!(t instanceof P))throw"IllegalArgumentException";var i,n,o,r,s,h,l=-(t.width>>1),a=-(t.height>>1),u=t.matrix,p=this.getPixelInside(0,0).zero(),c=this.clone();for(n=0;n<this.height;n++)for(i=0;i<this.width;i++){var d=p;for(r=n+a,h=0;h<t.height;h++,r++)for(o=i+l,s=0;s<t.width;s++,o++){var g=c.getPixel(o,r);g&&(d=d.addColor(g.mul(u[h][s])))}var f=c.getPixel(i,n),m=f.subColor(d).mul(e);this.setPixelInside(i,n,f.addColor(m))}},T.prototype.filterSharp=function(t){var e=P.makeSharpenFilter(t);this.convolution(e)},T.prototype.filterBlur=function(t){var e;e=P.makeBlur(t,1),this.convolution(e),e=P.makeBlur(1,t),this.convolution(e)},T.prototype.filterGaussian=function(t){var e;e=P.makeGaussianFilter(t,1),this.convolution(e),e=P.makeGaussianFilter(1,t),this.convolution(e)},T.prototype.filterUnSharp=function(t,e){var i=P.makeGaussianFilter(t,t);this.convolutionUnSharp(i,e)},T.prototype.filterBilateral=function(t,e){var i=P.makeGaussianFilter(t,t);this.convolutionBilateral(i,e)},T.prototype.filterSoftLens=function(t,e){var i=P.makeCircle(t);this.convolutionExp(i,e)},T.MODE_WRAP=x.MODE,T.MODE_IP=O.MODE,T.MODE_BLEND=_.MODE;function B(t,e,i){this.x=t,this.y=e,this.z=i}var D=function(e){function i(t){e.call(this),this.rgba=[t[0],t[1],t[2],t[3]]}e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i;var t={r:{configurable:!0},g:{configurable:!0},b:{configurable:!0},a:{configurable:!0}};return t.r.get=function(){return this.rgba[0]},t.g.get=function(){return this.rgba[1]},t.b.get=function(){return this.rgba[2]},t.a.get=function(){return this.rgba[3]},i.prototype.getColor=function(){return this.rgba},i.prototype.clone=function(){return new i(this.rgba)},i.prototype.zero=function(){return new i([0,0,0,0])},i.prototype.one=function(){return new i([1,1,1,1])},i.prototype.add=function(t){return new i([this.r+t,this.g+t,this.b+t,this.a+t])},i.prototype.sub=function(t){return new i([this.r-t,this.g-t,this.b-t,this.a-t])},i.prototype.mul=function(t){return new i([this.r*t,this.g*t,this.b*t,this.a*t])},i.prototype.div=function(t){return new i([this.r/t,this.g/t,this.b/t,this.a/t])},i.prototype.exp=function(){return new i([Math.exp(this.r),Math.exp(this.g),Math.exp(this.b),Math.exp(this.a)])},i.prototype.log=function(){return new i([Math.log(this.r),Math.log(this.g),Math.log(this.b),Math.log(this.a)])},i.prototype.pow=function(t){return new i([Math.pow(t,this.r),Math.pow(t,this.g),Math.pow(t,this.b),Math.pow(t,this.a)])},i.prototype.baselog=function(t){var e=1/Math.log(t);return new i([Math.log(this.r)*e,Math.log(this.g)*e,Math.log(this.b)*e,Math.log(this.a)*e])},i.prototype.table=function(t){return new i([t[Math.round(this.r)],t[Math.round(this.g)],t[Math.round(this.b)],t[Math.round(this.a)]])},i.prototype.random=function(){return new i([Math.floor(256*Math.random()),Math.floor(256*Math.random()),Math.floor(256*Math.random()),Math.floor(256*Math.random())])},i.prototype.luminance=function(){return.2126*this.r+.7152*this.g+.0722*this.b},i.prototype.addColor=function(t){return new i([this.r+t.r,this.g+t.g,this.b+t.b,this.a+t.a])},i.prototype.subColor=function(t){return new i([this.r-t.r,this.g-t.g,this.b-t.b,this.a-t.a])},i.prototype.mulColor=function(t){return new i([this.r*t.r,this.g*t.g,this.b*t.b,this.a*t.a])},i.prototype.divColor=function(t){return new i([this.r/t.r,this.g/t.g,this.b/t.b,this.a/t.a])},i.prototype.maxColor=function(t){return new i([Math.max(t.r,this.r),Math.max(t.g,this.g),Math.max(t.b,this.b),Math.max(t.a,this.a)])},i.prototype.minColor=function(t){return new i([Math.min(t.r,this.r),Math.min(t.g,this.g),Math.min(t.b,this.b),Math.min(t.a,this.a)])},i.prototype.norm=function(t){return t===e.NORM_MODE.MANHATTEN?(Math.abs(this.r)+Math.abs(this.g)+Math.abs(this.b))/3:t===e.NORM_MODE.EUGRID?Math.sqrt(this.r*this.r+this.g*this.g+this.b*this.b)/3:void 0},i.prototype.normFast=function(t){return t===e.NORM_MODE.MANHATTEN?Math.abs(this.r)+Math.abs(this.g)+Math.abs(this.b):t===e.NORM_MODE.EUGRID?this.r*this.r+this.g*this.g+this.b*this.b:void 0},i.prototype.getBlendAlpha=function(){return this.a/255},i.prototype.setBlendAlpha=function(t){var e=this.clone();return e.rgba[3]=255*t,e},i.prototype.exchangeColorAlpha=function(t){return new i([this.r,this.g,this.b,t.a])},i.prototype.getRRGGBB=function(){return this.r<<16|this.g<<8|255&this.b},i.prototype.getRed=function(){return this.r},i.prototype.getGreen=function(){return this.g},i.prototype.getBlue=function(){return this.b},i.prototype.equals=function(t){return this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a},i.prototype.toString=function(){return"color("+this.r+","+this.g+","+this.b+","+this.a+")"},i.prototype.mulMatrix=function(t){var e=new i;return e.rgba[0]=this.r*t[0][0]+this.g*t[0][1]+this.b*t[0][2]+this.a*t[0][3],e.rgba[1]=this.r*t[1][0]+this.g*t[1][1]+this.b*t[1][2]+this.a*t[1][3],e.rgba[2]=this.r*t[2][0]+this.g*t[2][1]+this.b*t[2][2]+this.a*t[2][3],e.rgba[3]=this.r*t[3][0]+this.g*t[3][1]+this.b*t[3][2]+this.a*t[3][3],e},Object.defineProperties(i.prototype,t),i}(S),R=function(e){function i(t){e.call(this),this.y=t}return e&&(i.__proto__=e),((i.prototype=Object.create(e&&e.prototype)).constructor=i).prototype.getColor=function(){return this.y},i.prototype.clone=function(){return new i(this.y)},i.prototype.zero=function(){return new i(0)},i.prototype.one=function(){return new i(1)},i.prototype.add=function(t){return new i(this.y+t)},i.prototype.sub=function(t){return new i(this.y-t)},i.prototype.mul=function(t){return new i(this.y*t)},i.prototype.div=function(t){return new i(this.y/t)},i.prototype.exp=function(){return new i(Math.exp(this.y))},i.prototype.log=function(){return new i(Math.log(this.y))},i.prototype.pow=function(t){return new i(Math.pow(t,this.y))},i.prototype.baselog=function(t){return new i(Math.log(this.y)/Math.log(t))},i.prototype.table=function(t){return new i(t[Math.floor(this.y)])},i.prototype.random=function(){return new i(256*Math.random())},i.prototype.luminance=function(){return this.y},i.prototype.addColor=function(t){return new i(this.y+t.y)},i.prototype.subColor=function(t){return new i(this.y-t.y)},i.prototype.mulColor=function(t){return new i(this.y*t.y)},i.prototype.divColor=function(t){return new i(this.y/t.y)},i.prototype.maxColor=function(t){return new i(Math.max(t.y,this.y))},i.prototype.minColor=function(t){return new i(Math.min(t.y,this.y))},i.prototype.norm=function(){return Math.abs(this.y)},i.prototype.normFast=function(){return Math.abs(this.y)},i.prototype.getBlendAlpha=function(){return 1},i.prototype.setBlendAlpha=function(){return this},i.prototype.exchangeColorAlpha=function(){return this},i.prototype.equals=function(t){return this.y===t.y},i.prototype.toString=function(){return"color("+this.y+")"},i}(S);B.prototype.cross=function(t){return new B(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},B.prototype.getDirection=function(t){return new B(t.x-this.x,t.y-this.y,t.z-this.z)},B.prototype.normalize=function(){var t=this.x*this.x+this.y*this.y+this.z*this.z;return t=Math.sqrt(1/t),new B(this.x*t,this.y*t,this.z*t)},B.prototype.getNormalMapColor=function(){return new D([Math.round(127.5*(1+this.x)),Math.round(127.5*(1-this.y)),Math.round(127.5*(1+this.z)),255])},B.createNormalVector=function(t){if(!(t instanceof D))throw"not ImgColorRGBA";return new B(t.r/128-1,-t.g/128+1,t.b/128-1)};var k=function(u){function o(){1===arguments.length?u.call(this,arguments[0]):2===arguments.length?u.call(this,arguments[0],arguments[1]):u.call(this)}return u&&(o.__proto__=u),((o.prototype=Object.create(u&&u.prototype)).constructor=o).prototype.clone=function(){var t=new o(this.width,this.height);return this._copyData(t),t},o.prototype.setSize=function(t,e){u.prototype.setSize.call(this,t,e),this.data=new Float32Array(this.width*this.height)},o.prototype.getPixelInside=function(t,e){var i=e*this.width+t;return new R(this.data[i])},o.prototype.setPixelInside=function(t,e,i){var n=e*this.width+t;this.data[n]=i.getColor()},o.prototype.putImageData=function(t,e){if(t instanceof ImageData||t instanceof H){this.setSize(t.width,t.height),void 0===e&&(e=0);for(var i=0,n=0;n<this.data.length;n++)this.data[n]=t.data[i+e],i+=4}else{if(!(t instanceof o))throw"IllegalArgumentException";this.setSize(t.width,t.height),this.data.set(t.data)}},o.prototype.putImageDataR=function(t){this.putImageData(t,0)},o.prototype.putImageDataG=function(t){this.putImageData(t,1)},o.prototype.putImageDataB=function(t){this.putImageData(t,2)},o.prototype.putImageDataA=function(t){this.putImageData(t,3)},o.prototype.getImageData=function(){var t=document.createElement("canvas");t.width=this.width,t.height=this.height;for(var e=t.getContext("2d").getImageData(0,0,t.width,t.height),i=0,n=0;n<this.data.length;n++){var o=Math.floor(this.data[n]);e.data[i+0]=o,e.data[i+1]=o,e.data[i+2]=o,e.data[i+3]=255,i+=4}return e},o.prototype.getNormalMap=function(){if(this.getWrapMode()===u.MODE_WRAP.INSIDE)throw"not inside";var t,e,i=new H(this.width,this.height);for(e=0;e<this.height;e++)for(t=0;t<this.width;t++){var n=new B(t-1,e,this.getPixel(t-1,e).getColor()),o=new B(t+1,e,this.getPixel(t+1,e).getColor()),r=n.getDirection(o),s=new B(t,e-1,this.getPixel(t,e-1).getColor()),h=new B(t,e+1,this.getPixel(t,e+1).getColor()),l=s.getDirection(h),a=r.cross(l).normalize();i.setPixelInside(t,e,a.getNormalMapColor())}return i},o.prototype.filterEnvironmentMapping=function(t){},o}(T),H=function(i){function n(){1===arguments.length?i.call(this,arguments[0]):2===arguments.length?i.call(this,arguments[0],arguments[1]):i.call(this)}return i&&(n.__proto__=i),((n.prototype=Object.create(i&&i.prototype)).constructor=n).prototype.clone=function(){var t=new n(this.width,this.height);return this._copyData(t),t},n.prototype.setSize=function(t,e){i.prototype.setSize.call(this,t,e),this.data=new Uint8ClampedArray(this.width*this.height*4)},n.prototype.getPixelInside=function(t,e){var i=4*(e*this.width+t);return new D([this.data[i],this.data[1+i],this.data[2+i],this.data[3+i]])},n.prototype.setPixelInside=function(t,e,i){var n=4*(e*this.width+t);this.data[n]=i.getColor()[0],this.data[1+n]=i.getColor()[1],this.data[2+n]=i.getColor()[2],this.data[3+n]=i.getColor()[3]},n.prototype.putDataY=function(t,e){if(!(t instanceof k))throw"IllegalArgumentException";this.setSize(t.width,t.height),void 0===e&&(e=0);for(var i=0,n=0;n<t.data.length;n++)this.data[i+e]=Math.floor(t.data[n]),i+=4},n.prototype.putDataYToR=function(t){this.putDataS(t,0)},n.prototype.putDataYToG=function(t){this.putDataS(t,1)},n.prototype.putDataYToB=function(t){this.putDataS(t,2)},n.prototype.putDataYToA=function(t){this.putDataS(t,3)},n.prototype.putImageData=function(t){if(t instanceof ImageData||t instanceof n)this.setSize(t.width,t.height),this.data.set(t.data);else{if(!(t instanceof k))throw"IllegalArgumentException";this.putImageData(t.getImageData())}},n.prototype.getImageData=function(){var t=document.createElement("canvas");t.width=this.width,t.height=this.height;var e=t.getContext("2d").getImageData(0,0,t.width,t.height);return e.data.set(this.data),e},n.prototype.grayscale=function(){this.forEach(function(t,e,i,n){var o=~~t.luminance(),r=new D([o,o,o,t.rgba[3]]);n.setPixelInside(e,i,r)})},n.prototype.getColorCount=function(){var o=new Uint8ClampedArray(2097152),r=0;return this.forEach(function(t){var e=t.getRRGGBB(),i=e>>3,n=e%7;0==(o[i]>>n&1)&&(r++,o[i]=255&(o[i]^1<<n))}),r},n.prototype.getPalletMedianCut=function(t){if(this.getColorCount()<=t)return null;var e,i,n,o,r,s,h,l,a,u,p,c=new Uint32Array(2097152),d=0,g=[],f=[[],[],[]],m=[[],[],[]];for(g[0]=this.width*this.height,e=0;e<3;e++)m[e][d]=0,f[e][d]=127;for(this.forEach(function(t){c[function(t){return t.getRed()>>1<<14|t.getGreen()>>1<<7|t.getBlue()>>1}(t)]++}),d++,p=1;d<t;){var y=0,E=0;for(e=0;e<p;e++){var v=(r=f[0][e]-m[0][e])*(s=f[1][e]-m[1][e])*(h=f[2][e]-m[2][e]);y<v&&(y=v,l=r,a=s,u=h,E=e)}var M=a,_=1;if(M<l&&(M=l,_=0),M<u&&(M=u,_=2),0===M)break;var C=m[_][E]+(M>>1);for(C===f[_][E]?(m[_][p]=C,f[_][p]=f[_][E],f[_][E]=C-1):(m[_][p]=C+1,f[_][p]=f[_][E],f[_][E]=C),e=0;e<3;e++)e!==_&&(m[e][p]=m[e][E],f[e][p]=f[e][E]);for(i=m[g[p]=0][p];i<=f[0][p];i++)for(n=m[1][p];n<=f[1][p];n++)for(o=m[2][p];o<=f[2][p];o++)g[p]+=c[i<<14|n<<7|o];if(g[E]-=g[p],0===g[E])for(g[E]=g[p],e=0;e<3;e++)m[e][E]=m[e][p],f[e][E]=f[e][p];else 0===g[p]||(p++,d++)}var w=[];for(e=0;e<d;e++){var b=0,S=0,N=0;for(i=m[0][e];i<=f[0][e];i++)for(n=m[1][e];n<=f[1][e];n++)for(o=m[2][e];o<=f[2][e];o++){var x=c[i<<14|n<<7|o];b+=x*(i<<1),S+=x*(n<<1),N+=x*(o<<1)}i=(i=Math.round(b/g[e]))<0?0:255<i?255:i,n=(n=Math.round(S/g[e]))<0?0:255<n?255:n,o=(o=Math.round(N/g[e]))<0?0:255<o?255:o,w[e]=new D([i,n,o,255])}return w},n.prototype.getPallet=function(){var i=[],n=new Uint32Array(256),o=0,r=0;return this.forEach(function(t){if(!(255<o)){var e=t.getRRGGBB();for(r=0;r<o;r++)if(n[r]===e)return;n[o]=e,i[o]=t,o++}}),i},n.prototype.getPalletGrayscale=function(t){var e,i=t<2?2:256<t?256:t,n=[],o=255/(i-1),r=0;for(e=0;e<i;e++){var s=Math.round(r);s=s<0?0:255<s?255:s,n[e]=new D([s,s,s,255]),r+=o}return n},n.prototype.quantizationSimple=function(r){this.forEach(function(t,e,i,n){var o=t.searchColor(r,S.NORM_MODE.EUGRID);n.setPixelInside(e,i,o.c1.color.exchangeColorAlpha(t))})},n.prototype.quantizationOrdered=function(c,d,g){this.forEach(function(t,e,i,n){var o=t.searchColor(c,g),r=o.c1.color,s=o.c1.norm,h=o.c2.color,l=o.c2.norm,a=s+l;a=0===a?1:a;var u=d.pattern[i%d.height][e%d.width],p=null;p=r.luminance>h.luminance?u<=Math.floor(l*d.maxnumber/a)?r.exchangeColorAlpha(t):h.exchangeColorAlpha(t):Math.floor(s*d.maxnumber/a)<=u?r.exchangeColorAlpha(t):h.exchangeColorAlpha(t),n.setPixelInside(e,i,p)})},n.prototype.quantizationDiffusion=function(u,p){var t=this.width*this.height,c=new Int16Array(t),d=new Int16Array(t),g=new Int16Array(t),f=0;this.forEach(function(t,e,i,n){f=i*n.width+e,c[f]=t.getRed(),d[f]=t.getGreen(),g[f]=t.getBlue()});var m,y,E=this.width-p.width+p.center,e=0;for(y=0;y<p.height;y++)for(m=0;m<p.width;m++)e+=p.pattern[y][m];var v=[];for(y=0;y<p.height;y++)for(v[y]=[],m=0;m<p.width;m++)v[y][m]=p.pattern[y][m]/e;this.forEach(function(t,e,i,n){f=i*n.width+e;var o=new D([c[f],d[f],g[f],255]),r=o.searchColor(u,S.NORM_MODE.EUGRID);if(r=r.c1.color,n.setPixelInside(e,i,r.exchangeColorAlpha(t)),!(E<e)){var s=o.subColor(r);for(y=0;y<p.height;y++)for(m=0===y?p.center:0;m<p.width;m++){var h=e+m-p.center,l=i+y;if(!(h<0||l>=n.height)){var a=l*n.width+h;c[a]+=s.getRed()*v[y][m],d[a]+=s.getGreen()*v[y][m],g[a]+=s.getBlue()*v[y][m]}}}})},n.prototype.filterQuantizationSimple=function(t){if(t<this.getColorCount()){var e=this.getPalletMedianCut(t);this.quantizationSimple(e)}},n.prototype.filterQuantizationOrdered=function(t,e){if(void 0===e&&(e=S.NORM_MODE.EUGRID),t<this.getColorCount()){var i=this.getPalletMedianCut(t);this.quantizationOrdered(i,n.quantization.orderPattern.patternBayer,e)}},n.prototype.filterQuantizationDiffusion=function(t,e){if(void 0===e&&(e=n.quantization.diffusionPattern.patternFloydSteinberg),t<this.getColorCount()){var i=this.getPalletMedianCut(t);this.quantizationDiffusion(i,e)}},n}(T);H.quantization={diffusionPattern:{patternFloydSteinberg:{width:3,height:2,center:1,pattern:[[0,0,7],[3,5,1]]},patternJarvisJudiceNinke:{width:5,height:3,center:2,pattern:[[0,0,0,7,5],[3,5,7,5,3],[1,3,5,3,1]]}},orderPattern:{patternBayer:{width:4,height:4,maxnumber:16,pattern:[[0,8,2,10],[12,4,14,6],[3,11,1,9],[15,7,13,5]]}}};function U(t,e){this.id="SComponent_"+(U._counter++).toString(16),this.wallid="SComponent_"+(U._counter++).toString(16),this.isshow=!1,this._element=null,this._wall=null,this.elementtype=t,this.unit=U.UNIT_TYPE.EM;var i=this,n=function(){U.node_tool.addClass(i.getElement(),U.CLASS_NAME.MOUSEOVER)},o=function(){U.node_tool.removeClass(i.getElement(),U.CLASS_NAME.MOUSEOVER),U.node_tool.removeClass(i.getElement(),U.CLASS_NAME.MOUSEDOWN)},r=function(){U.node_tool.addClass(i.getElement(),U.CLASS_NAME.MOUSEDOWN)},s=function(){U.node_tool.removeClass(i.getElement(),U.CLASS_NAME.MOUSEDOWN)};this.tool={attachMouseEvent:function(t){t.addEventListener("touchstart",n,!1),t.addEventListener("touchend",s,!1),t.addEventListener("mouseover",n,!1),t.addEventListener("mouseout",o,!1),t.addEventListener("mousedown",r,!1),t.addEventListener("mouseup",s,!1)},removeNodeForId:function(t){var e=document.getElementById(t);return U.node_tool.removeNode(e),e},AputB:function(t,e,i){if(!(t&&e&&e instanceof U))throw"IllegalArgumentException";if(t===e)throw"it referenced me";if(i!==U.PUT_TYPE.IN&&i!==U.PUT_TYPE.RIGHT&&i!==U.PUT_TYPE.NEWLINE)throw"IllegalArgumentException";var n=null;if("string"==typeof t||t instanceof String)n=document.getElementById(t);else if(t instanceof U)if(i===U.PUT_TYPE.IN){if(!t.isContainer())throw"not Container";n=t.getContainerElement()}else n=t.getElement();if(null===n)throw"Not Found "+t;function o(t,e){e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t)}if(e.removeMe(),i===U.PUT_TYPE.IN)e.onAdded(),null!==n.lastChild&&(e.getWall(U.PUT_TYPE.NEWLINE).style.display="block",n.appendChild(e.getWall())),e.getElement().style.display="inline-block",n.appendChild(e.getElement());else{if(null===n.parentNode)throw"not found element on the html";e.onAdded(),o(e.getWall(i),n),o(e.getElement(),e.getWall(i)),i===U.PUT_TYPE.RIGHT?(n.style.display="inline-block",e.getWall(i).style.display="inline-block",e.getElement().style.display="inline-block"):i===U.PUT_TYPE.NEWLINE&&(n.style.display="inline-block",e.getWall(i).style.display="block",e.getElement().style.display="inline-block")}}},this.setText(e)}var G={ImgDataRGBA:H,ImgColorRGBA:D,ImgDataY:k,ImgColorY:R,MODE_WRAP:T.MODE_WRAP,MODE_IP:T.MODE_IP,MODE_BLEND:T.MODE_BLEND};U.prototype.getWidth=function(){var t=this.getElement().style.width;return null===t?null:(t=t.match(/[+-]?\s*[0-9]*\.?[0-9]*/)[0],parseFloat(t))},U.prototype.getHeight=function(){var t=this.getElement().style.height;return null===t?null:(t=t.match(/[+-]?\s*[0-9]*\.?[0-9]*/)[0],parseFloat(t))},U.prototype.getSize=function(){return{width:this.getWidth(),height:this.getHeight()}},U.prototype.setWidth=function(t){if("number"!=typeof t)throw"IllegalArgumentException not number";this.getElement().style.width=t.toString()+this.unit},U.prototype.setHeight=function(t){if("number"!=typeof t)throw"IllegalArgumentException not number";this.getElement().style.height=t.toString()+this.unit},U.prototype.setSize=function(t,e){this.setWidth(t),this.setHeight(e)},U.prototype.removeMe=function(){this.tool.removeNodeForId(this.id),this.tool.removeNodeForId(this.space_id)},U.prototype.onAdded=function(){},U.prototype.getWall=function(t){if(this._wall)return this._wall;var e=document.createElement("span");return e.id=this.wallid,t===U.PUT_TYPE.RIGHT?e.className=U.CLASS_NAME.SPACE:t===U.PUT_TYPE.NEWLINE&&(e.className=U.CLASS_NAME.NEWLINE),e.style.display="inline-block",this._wall=e},U.prototype.isContainer=function(){return null!==this.getContainerElement()},U.prototype.getContainerElement=function(){return null},U.prototype.getElement=function(){if(this._element)return this._element;var t=document.createElement(this.elementtype);return t.id=this.id,t.className=U.CLASS_NAME.COMPONENT,t.style.display="inline-block",this._element=t,this.tool.attachMouseEvent(t),t},U.prototype.put=function(t,e){this.tool.AputB(this,t,e)},U.prototype.putMe=function(t,e){this.tool.AputB(t,this,e)},U.prototype.isVisible=function(){return null===this.getElement().style.visibility||"hidden"!==this.getElement().style.visibility},U.prototype.setVisible=function(t){t?(this.getElement().style.visibility="visible",this.getWall().style.visibility="visible"):(this.getElement().style.visibility="hidden",this.getWall().style.visibility="hidden")},U.prototype.getTextNode=function(){var t=this.getElement().childNodes,e=null,i=0;for(i=0;i<t.length;i++)if(t[i]instanceof Text){e=t[i];break}return e},U.prototype.getElementNode=function(){var t=this.getElement().children,e=null,i=0;for(i=0;i<t.length;i++)if(!(t[i]instanceof Text)){e=t[i];break}return e},U.prototype.getEditableNodeForValue=function(){return null},U.prototype.getEditableNodeForNodeValue=function(){if(this.getEditableNodeForValue())return null;var t=this.getTextNode();if(null===t){var e=this.getElement();t=document.createTextNode(""),e.appendChild(t)}return t},U.prototype.setText=function(t){if(t){var e=null;(e=this.getEditableNodeForValue())?e.value=t:(e=this.getEditableNodeForNodeValue())&&(e.nodeValue=t)}},U.prototype.getText=function(){var t=null,e=null;return(e=this.getEditableNodeForValue())&&(t=e.value),(e=this.getEditableNodeForNodeValue())&&(t=e.nodeValue.trim()),null===t?"":t},U.prototype.getEnabledElement=function(){return null},U.prototype.setEnabled=function(t){t?U.node_tool.removeClass(this.getElement(),U.CLASS_NAME.DISABLED):U.node_tool.addClass(this.getElement(),U.CLASS_NAME.DISABLED);var e=this.getEnabledElement();null!==e&&U.node_tool.setBooleanAttribute(e,"disabled",t)},U.prototype.isEnabled=function(){return!U.node_tool.isSetClass(this.getElement(),U.CLASS_NAME.DISABLED)},U.prototype.getId=function(){return this.id},U.prototype.getUnit=function(){return this.unit},U.prototype.setUnit=function(t){this.unit=t},U.prototype.addClass=function(t){return U.node_tool.addClass(this.getElement(),t)},U.prototype.toString=function(){return this._elementtype+"("+this.id+")"},U.PUT_TYPE={IN:0,RIGHT:1,NEWLINE:2},U.UNIT_TYPE={PX:"px",EM:"em",PERCENT:"%"},U.LABEL_POSITION={LEFT:0,RIGHT:1},U.CLASS_NAME={MOUSEOVER:"SCOMPONENT_MouseOver",MOUSEDOWN:"SCOMPONENT_MouseDown",DISABLED:"SCOMPONENT_Disabled",COMPONENT:"SCOMPONENT_Component",NEWLINE:"SCOMPONENT_Newline",CLOSE:"SCOMPONENT_Close",OPEN:"SCOMPONENT_Open",SPACE:"SCOMPONENT_Space",CONTENTSBOX:"SCOMPONENT_ContentsBox",PANEL:"SCOMPONENT_Panel",PANEL_LEGEND:"SCOMPONENT_PanelLegend",SLIDEPANEL:"SCOMPONENT_SlidePanel",SLIDEPANEL_LEGEND:"SCOMPONENT_SlidePanelLegend",SLIDEPANEL_SLIDE:"SCOMPONENT_SlidePanelSlide",GROUPBOX:"SCOMPONENT_GroupBox",GROUPBOX_LEGEND:"SCOMPONENT_GroupBoxLegend",IMAGEPANEL:"SCOMPONENT_ImagePanel",LABEL:"SCOMPONENT_Label",SELECT:"SCOMPONENT_Select",COMBOBOX:"SCOMPONENT_ComboBox",CHECKBOX:"SCOMPONENT_CheckBox",CHECKBOX_IMAGE:"SCOMPONENT_CheckBoxImage",BUTTON:"SCOMPONENT_Button",FILELOAD:"SCOMPONENT_FileLoad",FILESAVE:"SCOMPONENT_FileSave",CANVAS:"SCOMPONENT_Canvas",PROGRESSBAR:"SCOMPONENT_ProgressBar",SLIDER:"SCOMPONENT_Slider",COLORPICKER:"SCOMPONENT_ColorPicker"},U._counter=0,U.node_tool={setBooleanAttribute:function(t,e,i){if("string"!=typeof e&&!(e instanceof String)||"boolean"!=typeof i)throw"IllegalArgumentException";var n=t.getAttribute(e);i||null!==n?i&&null!==n&&t.removeAttribute(e):t.setAttribute(e,e)},isBooleanAttribute:function(t,e){if("string"!=typeof e&&!(e instanceof String))throw"IllegalArgumentException";return null===t.getAttribute(e)},removeNode:function(t){return t&&t.parentNode&&t.parentNode.removeChild(t),t},removeChildNodes:function(t){for(var e=t.lastChild;e;)t.removeChild(e),e=t.lastChild},isSetClass:function(t,e){var i=t.className;return null!==i&&new RegExp("(^"+e+"$)|( +"+e+")","g").test(i)},addClass:function(t,e){var i=t.className;null!==i?new RegExp("(^"+e+"$)|( +"+e+")","g").test(i)||(t.className=i+" "+e):t.className=e},removeClass:function(t,e){var i=t.className;if(null!==i){var n=new RegExp("(^"+e+"$)|( +"+e+")","g");n.test(i)&&(t.className=i.replace(n,""))}}};var z=function(e){function t(t){e.call(this,"input",t),this.addClass(e.CLASS_NAME.BUTTON),this.getElement().type="button"}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getEditableNodeForValue=function(){return this.getElement()},t.prototype.getEnabledElement=function(){return this.getElement()},t.prototype.addListener=function(t){this.getElement().addEventListener("click",t,!1)},t}(U),F=function(l){function a(){l.call(this,"canvas"),this.addClass(l.CLASS_NAME.CANVAS),this.canvas=l.prototype.getElement.call(this),this.glmode=!1,this.setPixelSize(300,150)}return l&&(a.__proto__=l),((a.prototype=Object.create(l&&l.prototype)).constructor=a).prototype.getPixelSize=function(){return{width:this.canvas.width,height:this.canvas.height}},a.prototype.getCanvas=function(){return this.canvas},a.prototype.setPixelSize=function(t,e){if(2!==arguments.length||"number"!=typeof t||"number"!=typeof e||t<0||e<0)throw"IllegalArgumentException";t=~~Math.floor(t),e=~~Math.floor(e),this.canvas.width=t,this.canvas.height=e},a.prototype.getContext=function(){return void 0===this.context&&(this.context=this.canvas.getContext("2d"),null===this.context&&(this.glmode=!0,this.gl=this.canvas.getContext("webgl")||this.canvas.getContext("experimental-webgl"),this.context=this.gl)),this.context},a.prototype.clear=function(){this.glmode?this.getContext().clear(this.gl.COLOR_BUFFER_BIT):this.getContext().clearRect(0,0,this.canvas.width,this.canvas.height)},a.prototype.getImageData=function(){if(!this.glmode)return this.getContext().getImageData(0,0,this.canvas.width,this.canvas.height)},a.prototype.putImageData=function(t){this.glmode||this.getContext().putImageData(t,0,0)},a.prototype._putImage=function(t,e,i){var n=this.canvas,o=0,r=0,s=n.width,h=n.height;a.drawtype.ORIGINAL===i?(s=t.width,h=t.height):a.drawtype.STRETCH===i?(s=n.width,h=n.height):a.drawtype.FILL_ASPECT_RATIO===i?(s=n.width,h=n.height):(s=t.width,h=t.height,a.drawtype.ASPECT_RATIO===i&&(s>n.width&&(s=n.width,h=Math.floor(h*(s/t.width))),h>n.height&&(s=Math.floor(s*(n.height/h)),h=n.height)),a.drawtype.LETTER_BOX===i&&(s=n.width,(h=Math.floor(h*(s/t.width)))>n.height&&(s=Math.floor(s*(n.height/h)),h=n.height),o=Math.floor((n.width-s)/2),r=Math.floor((n.height-h)/2),e=!1)),e&&(this.setUnit(l.UNIT_TYPE.PX),this.setSize(s,h),this.setPixelSize(s,h)),this.clear(),t instanceof Image?this.context.drawImage(t,0,0,t.width,t.height,o,r,s,h):t instanceof ImageData&&this.context.putImageData(t,0,0,o,r,s,h)},a.prototype.putImage=function(t,e,i,n){if(e=e||null,void 0===i&&(i=a.drawtype.LETTER_BOX),void 0===n&&(n=!1),t instanceof Image||t instanceof ImageData)this._putImage(t,n,i),"function"==typeof e&&e();else if("string"==typeof t){var o=this,r=new Image;r.onload=function(){o.putImage(r,n,i,e)},r.src=t}else if(t instanceof a)this.putImage(t.getElement(),n,i,e);else if(t instanceof Element&&"CANVAS"===t.tagName)this.putImage(t.toDataURL(),n,i,e);else{if(!(t instanceof Blob||t instanceof File))throw"IllegalArgumentException";var s=this,h=new FileReader;h.onload=function(){s.putImage(h.result,n,i,e)},h.readAsDataURL(t)}},a.prototype.toDataURL=function(t){return t=t||"image/png",this.canvas.toDataURL(t)},a}(U);F.drawtype={ORIGINAL:0,ASPECT_RATIO:1,STRETCH:2,LETTER_BOX:3};var V=function(o){function t(t){o.call(this,"label"),this.addClass(o.CLASS_NAME.LABEL),this.addClass(o.CLASS_NAME.CHECKBOX);var e=document.createElement("input");e.type="checkbox",e.id=this.getId()+"_checkbox",e.className=o.CLASS_NAME.CHECKBOX_IMAGE,this.checkbox=e,this.textnode=document.createTextNode(t||"");var i=this.getElement();i.appendChild(this.checkbox),i.appendChild(this.textnode)}return o&&(t.__proto__=o),((t.prototype=Object.create(o&&o.prototype)).constructor=t).prototype.getEnabledElement=function(){return this.checkbox},t.prototype.getTextNode=function(){return this.textnode},t.prototype.getElementNode=function(){return this.checkbox},t.prototype.setLabelPosition=function(t){var e=this.getElement(),i=this.getTextNode(),n=this.getElementNode();this.node_tool.removeChildNodes(e),t===o.LABEL_POSITION.LEFT?(e.appendChild(i),e.appendChild(n)):(e.appendChild(n),e.appendChild(i))},t.prototype.setCheckBoxImageSize=function(t){if("number"!=typeof t)throw"IllegalArgumentException not number";this.checkbox.style.height=t.toString()+this.unit,this.checkbox.style.width=t.toString()+this.unit},t.prototype.addListener=function(t){this.checkbox.addEventListener("change",t,!1)},t.prototype.setChecked=function(t){this.checkbox.checked=t},t.prototype.isChecked=function(){return this.checkbox.checked},t}(U),W=function(s){function t(){s.call(this,"div"),this.addClass(s.CLASS_NAME.COLORPICKER);for(var t=this.getElement(),r=this,l={H:{div:document.createElement("div"),split:6,value:0,input:null,gauge:null,color_data:[],color_node:[],is_press:!1},S:{div:document.createElement("div"),split:1,value:.5,input:null,gauge:null,color_data:[],color_node:[],is_press:!1},L:{div:document.createElement("div"),split:2,value:.5,input:null,gauge:null,color_data:[],color_node:[],is_press:!1}},e=0;e<=l.H.split;e++){var i=1/l.H.split*e;l.H.color_data.push(p.newColorNormalizedHSL([i,1,.5]).getCSSHex())}function a(i){return function(t){if(t.length&&(t=t[0]),l[i].is_press){var e=t.target;e=e||t.currentTarget,l[i].value=t.offsetX/e.clientWidth,r.redraw()}}}function u(i,n){return function(t){t.length&&(t=t[0]);var e=t.target;e=e||t.currentTarget,(l[i].is_press=n)&&a(i)(t)}}function n(t){var e=document.createElement("span"),i=document.createElement("div"),n=document.createElement("input");e.style.display="inline-block",i.style.display="inline-block",n.style.display="inline-block",e.style.verticalAlign="top",i.style.verticalAlign="top",n.style.verticalAlign="top",e.style.height="100%",i.style.height="100%",n.style.height="100%",e.style.margin="0px",e.style.padding="0px",e.style.textAlign="center",i.style.margin="0px 0.5em 0px 0.5em",i.style.padding="0px",i.style.borderStyle="solid",i.style.borderWidth="1px",n.addEventListener("input",function(i){return function(t){var e=t.target;e=e||t.currentTarget,l[i].value=e.value/100,r.redraw()}}(t),!1),n.type="number",n.style.margin="0px",n.style.padding="0px",n.style.borderStyle="none",n.min=0,n.max=100,n.step=1,l[t].input=n,e.style.width="1.5em",i.style.width="calc(100% - 6.0em)",n.style.width="3.5em",function(t,e){var i=document.createElement("div"),n=document.createElement("div"),o=document.createElement("div");t.style.position="relative",i.style.position="absolute",n.style.position="absolute",o.style.position="absolute",i.style.margin="0px",i.style.padding="0px",n.style.margin="0px",n.style.padding="0px",o.style.margin="0px",o.style.padding="0px",i.addEventListener("mousedown",u(e,!0),!1),i.addEventListener("mouseup",u(e,!1),!1),i.addEventListener("mouseout",u(e,!1),!1),i.addEventListener("mousemove",a(e),!1),i.addEventListener("touchstart",u(e,!0),!1),i.addEventListener("touchend",u(e,!1),!1),i.addEventListener("touchcancel",u(e,!1),!1),i.dataset.name=e,i.style.width="100%",i.style.height="100%",i.style.bottom="0px",n.style.width="33%",n.style.height="100%",n.style.bottom="0px",n.style.borderStyle="ridge",n.style.borderWidth="0px 2px 0px 0px",l[e].gauge=n;var r=l[e].split;o.style.width="100%",o.style.height="100%",o.style.overflow="hidden";for(var s=0;s<r;s++){var h=document.createElement("div");h.style.display="inline-block",h.style.margin="0px",h.style.padding="0px",h.style.height="100%",h.style.width=100/r+"%",h.style.background="linear-gradient(to right, #000, #FFF)",l[e].color_node.push(h),o.appendChild(h)}t.appendChild(o),t.appendChild(n),t.appendChild(i)}(i,t);var o=l[t].div;o.style.height="1.2em",o.style.margin="0.5em 0px 0.5em 0px",e.appendChild(document.createTextNode(t)),o.appendChild(e),o.appendChild(i),o.appendChild(n)}for(var o in l)n(o);this.hls=l,this.listener=[],this.redraw(),t.appendChild(this.hls.H.div),t.appendChild(this.hls.S.div),t.appendChild(this.hls.L.div)}return s&&(t.__proto__=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.setColor=function(t){if(!(t instanceof p))throw"ArithmeticException";var e=this.hls,i=t.getNormalizedHSL();e.H.value=i.h,e.S.value=i.s,e.L.value=i.l,this.redraw()},t.prototype.getColor=function(){var t=this.hls,e=t.H.value,i=t.S.value,n=t.L.value;return p.newColorNormalizedHSL([e,i,n])},t.prototype.redraw=function(){var t=this.hls,e=t.H.value,i=t.S.value,n=t.L.value;for(var o in t.S.color_data=[p.newColorNormalizedHSL([e,0,n]).getCSSHex(),p.newColorNormalizedHSL([e,1,n]).getCSSHex()],t.L.color_data=[p.newColorNormalizedHSL([e,i,0]).getCSSHex(),p.newColorNormalizedHSL([e,i,.5]).getCSSHex(),p.newColorNormalizedHSL([e,i,1]).getCSSHex()],t){for(var r=t[o].color_data,s=t[o].color_node,h=0;h<s.length;h++)s[h].style.background="linear-gradient(to right, "+r[h]+", "+r[h+1]+")";var l=Math.round(100*t[o].value);t[o].gauge.style.width=l+"%",t[o].input.value=l}for(var a=0;a<this.listener.length;a++)this.listener[a]()},t.prototype.addListener=function(t){this.listener.push(t)},t}(U),Y=function(e){function t(t){e.call(this,"select",t),this.addClass(e.CLASS_NAME.SELECT),this.addClass(e.CLASS_NAME.COMBOBOX)}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getEnabledElement=function(){return this.getElement()},t.prototype.addListener=function(t){this.getElement().addEventListener("change",t,!1)},t.prototype.setText=function(t){if(t){var e=this.getElement();"string"==typeof t&&t instanceof String&&(t=[t]);for(var i=e.lastChild;i;)e.removeChild(i),i=e.lastChild;var n=0;for(n=0;n<t.length;n++){var o=document.createElement("option");o.text=t[n].toString(),o.value=t[n].toString(),e.appendChild(o)}}},t.prototype.getText=function(){var t=this.getElement().children,e=0,i=[];for(e=0;e<t.length;e++)"OPTION"===t[e].tagName&&(i[i.length]=t[e].text);return i},t.prototype.setSelectedItem=function(t){var e=this.getElement().children,i=0,n=0;for(i=0;i<e.length;i++)if("OPTION"===e[i].tagName){if(e[i].value===t.toString()){this.getElement().selectedIndex=n;break}n++}},t.prototype.getSelectedItem=function(){var t=this.getElement().children,e=this.getElement().selectedIndex,i=0,n=0;for(i=0;i<t.length;i++)if("OPTION"===t[i].tagName){if(e===n)return t[i].value;n++}return""},t}(U),j=function(n){function e(t){n.call(this,"label",t),this.addClass(n.CLASS_NAME.BUTTON),this.addClass(n.CLASS_NAME.FILELOAD);var e=n.prototype.getElement.call(this),i=document.createElement("input");e.style.textAlign="center",i.setAttribute("type","file"),i.id=this.getId()+"_file",i.style.display="none",this.file=i,e.appendChild(i)}return n&&(e.__proto__=n),((e.prototype=Object.create(n&&n.prototype)).constructor=e).prototype.getEnabledElement=function(){return this.file},e.prototype.getFileAccept=function(){var t=this.file.getAttribute("accept");return null===t?"":t},e.prototype.setFileAccept=function(t){t===e.FILE_ACCEPT.DEFAULT?null!==this.file.getAttribute("accept")&&this.file.removeAttribute("accept"):this.file.accept=t},e.prototype.addListener=function(e){this.file.addEventListener("change",function(t){e(t.target.files)},!1)},e}(U);j.FILE_ACCEPT={DEFAULT:"",IMAGE:"image/*",AUDIO:"audio/*",VIDEO:"video/*",TEXT:"text/*",PNG:"image/png",JPEG:"image/jpg",GIF:"image/gif"};var X={Button:z,Canvas:F,CheckBox:V,ColorPicker:W,ComboBox:Y,FileLoadButton:j,FileSaveButton:function(e){function t(t){e.call(this,"a",t),this.addClass(e.CLASS_NAME.BUTTON),this.addClass(e.CLASS_NAME.FILESAVE),this.filename="",this.url="",this.getElement().setAttribute("download",this.filename)}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getFileName=function(){return this.filename},t.prototype.setFileName=function(t){this.filename=t,this.getElement().setAttribute("download",this.filenam)},t.prototype.setURL=function(t){this.getElement().href=t,this.url=t},t.prototype.setEnabled=function(t){this.isEnabled()!==t&&(t?this.getElement().href=this.url:this.getElement().removeAttribute("href")),e.prototype.setEnabled.call(this,t)},t}(U),GroupBox:function(i){function t(t){i.call(this,"fieldset"),this.addClass(i.CLASS_NAME.GROUPBOX),this.legend=document.createElement("legend"),i.node_tool.addClass(this.legend,i.CLASS_NAME.GROUPBOX_LEGEND),this.legend.id=this.getId()+"_legend",this.legend.textContent=t,this.body=document.createElement("div"),i.node_tool.addClass(this.body,i.CLASS_NAME.CONTENTSBOX),this.body.id=this.getId()+"_body";var e=this.getElement();e.appendChild(this.legend),e.appendChild(this.body)}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.getEnabledElement=function(){return this.getElement()},t.prototype.getContainerElement=function(){return this.body},t.prototype.clear=function(){i.node_tool.removeChildNodes(this.body)},t}(U),ImagePanel:function(e){function t(){e.call(this,"div"),this.addClass(e.CLASS_NAME.IMAGEPANEL);var t=document.createElement("img");t.id=this.id+"_img",this.image=t,this.getElement().appendChild(this.image)}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.clear=function(){this.node_tool.removeChildNodes(this.getElement())},t.prototype.toDataURL=function(){return this.image.src},t.prototype.putImageData=function(t){this.putImage(t)},t.prototype.putImage=function(e,i){if(i=i||null,"string"==typeof e)this.image.onload=function(){"function"==typeof i&&i()},this.image.src=e;else if(e instanceof ImageData){var t=document.createElement("canvas");t.width=e.width,t.height=e.height,t.getContext("2d").putImageData(e,0,0),this.putImage(t,i)}else if(e instanceof Image)this.image.src=e.src;else if(e instanceof F)this.putImage(e.getElement(),i);else if(e instanceof Element&&"CANVAS"===e.tagName)try{this.putImage(e.toDataURL("image/png"),i)}catch(t){try{this.putImage(e.toDataURL("image/jpeg"),i)}catch(t){}}else{if(!(e instanceof Blob||e instanceof File))throw"IllegalArgumentException";var n=this,o=new FileReader;o.onload=function(){n.putImage(o.result,i)},o.readAsDataURL(e)}},t}(U),Label:function(e){function t(t){e.call(this,"div",t),this.addClass(e.CLASS_NAME.LABEL)}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getContainerElement=function(){return this.getElement()},t}(U),Panel:function(n){function t(t){n.call(this,"div",null),this.addClass(n.CLASS_NAME.PANEL);var e=this.getElement();this.legend=document.createElement("span"),n.node_tool.addClass(this.legend,n.CLASS_NAME.PANEL_LEGEND),this.legend.id=this.getId()+"_legend",this.body=document.createElement("div"),n.node_tool.addClass(this.body,n.CLASS_NAME.CONTENTSBOX),this.body.id=this.getId()+"_body";var i=this;this.paneltool={setText:function(t){t?(i.legend.textContent=t,i.legend.style.display="block"):i.legend.style.display="none"}},this.paneltool.setText(t),e.appendChild(this.legend),e.appendChild(this.body)}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.setText=function(t){this.paneltool&&this.paneltool.setText(t)},t.prototype.getContainerElement=function(){return this.body},t.prototype.clear=function(){n.node_tool.removeChildNodes(this.body)},t}(U),ProgressBar:function(i){function t(t,e){if(i.call(this,"label"),this.addClass(i.CLASS_NAME.LABEL),this.addClass(i.CLASS_NAME.PROGRESSBAR),this.min=0,this.max=0,this.value=t,this.is_indeterminate=!1,0===arguments.length)this.min=0,this.max=1;else{if(2!==arguments.length)throw"IllegalArgumentException";this.min=t,this.max=e}this.progress=document.createElement("progress"),this.getElement().appendChild(this.progress),this.progress.id=this.getId()+"_progress",this.progress.className=i.CLASS_NAME.PROGRESSBAR,this.progress.value=0,this.progress.max=1}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.setMaximum=function(t){this.max=t},t.prototype.setMinimum=function(t){this.min=t},t.prototype.getMaximum=function(){return this.max},t.prototype.getMinimum=function(){return this.min},t.prototype.setValue=function(t){this.value=t,this.progress.value=this.getPercentComplete()},t.prototype.getValue=function(){return this.value},t.prototype.setIndeterminate=function(t){this.is_indeterminate=t,this.is_indeterminate?this.progress.removeAttribute("value"):this.setValue(this.value)},t.prototype.isIndeterminate=function(){return this.is_indeterminate},t.prototype.getPercentComplete=function(){var t=this.max-this.min;return(this.value-this.min)/t},t}(U),SlidePanel:function(n){function t(t){n.call(this,"div"),this.addClass(n.CLASS_NAME.SLIDEPANEL),this.textnode=document.createTextNode(t||""),this.legend=document.createElement("span"),n.node_tool.addClass(this.legend,n.CLASS_NAME.SLIDEPANEL_LEGEND),this.legend.id=this.getId()+"_legend",this.legend.appendChild(this.textnode),this.slide=document.createElement("div"),n.node_tool.addClass(this.slide,n.CLASS_NAME.SLIDEPANEL_SLIDE),this.slide.id=this.getId()+"_slide",this.body=document.createElement("div"),n.node_tool.addClass(this.body,n.CLASS_NAME.CONTENTSBOX),this.body.id=this.getId()+"_body";var e=this;this.legend.addEventListener("click",function(){e.setOpen(!e.isOpen())}),this.setOpen(!1),this.slide.appendChild(this.body);var i=n.prototype.getElement.call(this);i.appendChild(this.legend),i.appendChild(this.slide)}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.setOpen=function(t){this.is_open=t,this.is_open?(this.slide.style.maxHeight=this.body.scrollHeight+"px",n.node_tool.addClass(this.legend,n.CLASS_NAME.OPEN),n.node_tool.removeClass(this.legend,n.CLASS_NAME.CLOSE)):(this.slide.style.maxHeight=null,n.node_tool.addClass(this.legend,n.CLASS_NAME.CLOSE),n.node_tool.removeClass(this.legend,n.CLASS_NAME.OPEN))},t.prototype.isOpen=function(){return this.is_open},t.prototype.getTextNode=function(){return this.textnode},t.prototype.getContainerElement=function(){return this.body},t.prototype.clear=function(){n.node_tool.removeChildNodes(this.body)},t}(U),Slider:function(i){function t(t,e){if(i.call(this,"label"),this.addClass(i.CLASS_NAME.LABEL),this.addClass(i.CLASS_NAME.SLIDER),0===arguments.length)t=0,e=1;else if(2!==arguments.length)throw"IllegalArgumentException";this.slider=document.createElement("input"),this.slider.id=this.getId()+"_slider",this.slider.type="range",this.slider.className=i.CLASS_NAME.SLIDER,this.slider.value=t,this.slider.min=t,this.slider.max=e,this.slider.step=(e-t)/100,this.datalist=document.createElement("datalist"),this.datalist.id=this.getId()+"_datalist",this.slider.setAttribute("list",this.datalist.id),this.getElement().appendChild(this.slider),this.getElement().appendChild(this.datalist)}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.getEnabledElement=function(){return this.slider},t.prototype.setMaximum=function(t){this.slider.max=t},t.prototype.setMinimum=function(t){this.slider.min=t},t.prototype.getMaximum=function(){return parseFloat(this.slider.max)},t.prototype.getMinimum=function(){return parseFloat(this.slider.min)},t.prototype.setValue=function(t){this.slider.value=t},t.prototype.getValue=function(){return parseFloat(this.slider.value)},t.prototype.setMinorTickSpacing=function(t){this.slider.step=t},t.prototype.getMinorTickSpacing=function(){return parseFloat(this.slider.step)},t.prototype.setMajorTickSpacing=function(t){var e;this.majortick=t,this.removeMajorTickSpacing();var i=this.getMinimum(),n=this.getMaximum();for(e=i;e<=n;e+=t){var o=document.createElement("option");o.value=e.toString(),this.datalist.appendChild(o)}},t.prototype.getMajorTickSpacing=function(){return this.majortick},t.prototype.removeMajorTickSpacing=function(){for(var t=this.datalist,e=t.lastChild;e;)t.removeChild(e),e=t.lastChild},t.prototype.addListener=function(t){function e(){n=!0}function i(){n&&("disabled"!==o.slider.disabled&&t(),n=!1)}var n=!1,o=this;this.slider.addEventListener("touchstart",e,!1),this.slider.addEventListener("touchend",i,!1),this.slider.addEventListener("mousedown",e,!1),this.slider.addEventListener("mouseup",i,!1)},t.prototype.getWidth=function(){var t=this.slider.width;return null===t?null:(t=t.match(/[+-]?\s*[0-9]*\.?[0-9]*/)[0],parseFloat(t))},t.prototype.getHeight=function(){var t=this.slider.height;return null===t?null:(t=t.match(/[+-]?\s*[0-9]*\.?[0-9]*/)[0],parseFloat(t))},t.prototype.setWidth=function(t){if("number"!=typeof t)throw"IllegalArgumentException not number";i.prototype.setWidth.call(this,t),this.slider.style.width=t.toString()+this.unit},t.prototype.setHeight=function(t){if("number"!=typeof t)throw"IllegalArgumentException not number";i.prototype.setHeight.call(this,t),this.slider.style.height=t.toString()+this.unit},t}(U),PUT_TYPE:U.PUT_TYPE,UNIT_TYPE:U.UNIT_TYPE,LABEL_POSITION:U.LABEL_POSITION,FILE_ACCEPT:j.FILE_ACCEPT},K={_printbuffer:""};return K.ArrayList=i,K.Color=p,K.File=r,K.HashMap=o,K.format=t.format,K.Log=d,K.Programming=m,K.Device=w,K.ImageProcessing=G,K.SComponent=X,K});
